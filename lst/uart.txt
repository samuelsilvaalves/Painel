; generated by ARM C/C++ Compiler, 4.1 [Build 644]
; commandline ArmCC [--list --debug -c --asm --interleave -o.\out\uart.o --asm_dir=.\lst\ --list_dir=.\lst\ --depend=.\out\uart.d --cpu=Cortex-M3 --apcs=interwork -I.\inc -I.\inc\file_system -I.\inc\IR -IC:\Keil\ARM\RL\TCPnet\Drivers -I.\inc\tcpip -IC:\Keil\ARM\CMSIS\Include -IC:\Keil\ARM\INC\NXP\LPC17xx -DLPC1700 -DFLASH_512 --omf_browse=.\out\uart.crf src\uart.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=2

                          REQUIRE _printf_percent
                          REQUIRE _printf_u
                          REQUIRE _printf_int_dec
                          REQUIRE _printf_s
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_c
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                          REQUIRE _printf_str
                  get_entry PROC
;;;93      *---------------------------------------------------------------------------*/
;;;94     char *get_entry (char *cp, char **pNext) 
000000  b570              PUSH     {r4-r6,lr}
;;;95     {
;;;96     	char *sp, lfn = 0, sep_ch = ' ';
000002  2400              MOVS     r4,#0
000004  2520              MOVS     r5,#0x20
000006  4626              MOV      r6,r4
;;;97     
;;;98       	if(cp == NULL) 
000008  b938              CBNZ     r0,|L1.26|
;;;99     	{                           
;;;100    		/* skip NULL pointers */
;;;101       		*pNext = cp;
;;;102       		return (cp);
00000a  6008              STR      r0,[r1,#0]
;;;103      	}
;;;104      	for ( ; *cp == ' ' || *cp == '\"'; cp++) 
;;;105    	{  
;;;106    		/* skip blanks and starting  " */
;;;107       		if (*cp == '\"') 
;;;108    		{ 
;;;109    			sep_ch = '\"'; 
;;;110    			lfn = 1; 
;;;111    		}
;;;112       		*cp = 0;
;;;113      	}
;;;114      	for (sp = cp; *sp != CR && *sp != LF; sp++) 
;;;115      	{
;;;116       		if ( lfn && *sp == '\"') 
;;;117    			break;
;;;118       		if (!lfn && *sp == ' ' ) 
;;;119    			break;
;;;120      	}
;;;121      	for ( ; *sp == sep_ch || *sp == CR || *sp == LF || *sp == '!'; sp++) 
;;;122    	{
;;;123       		*sp = 0;
;;;124       		if ( lfn && *sp == sep_ch) 
;;;125    		{ 
;;;126    			sp ++; 
;;;127    			break; 
;;;128    		}
;;;129      }
;;;130      *pNext = (*sp) ? sp : NULL;     /* next entry */
;;;131      return (cp);
;;;132    }
00000c  bd70              POP      {r4-r6,pc}
                  |L1.14|
00000e  2a22              CMP      r2,#0x22              ;107
000010  d101              BNE      |L1.22|
000012  2522              MOVS     r5,#0x22              ;109
000014  2401              MOVS     r4,#1                 ;110
                  |L1.22|
000016  f8006b01          STRB     r6,[r0],#1            ;112
                  |L1.26|
00001a  7802              LDRB     r2,[r0,#0]            ;104
00001c  2a20              CMP      r2,#0x20              ;104
00001e  d0f6              BEQ      |L1.14|
000020  2a22              CMP      r2,#0x22              ;104
000022  d0f4              BEQ      |L1.14|
000024  4602              MOV      r2,r0                 ;114
000026  e006              B        |L1.54|
                  |L1.40|
000028  b114              CBZ      r4,|L1.48|
00002a  2b22              CMP      r3,#0x22              ;116
00002c  d00d              BEQ      |L1.74|
00002e  e001              B        |L1.52|
                  |L1.48|
000030  2b20              CMP      r3,#0x20              ;118
000032  d00a              BEQ      |L1.74|
                  |L1.52|
000034  1c52              ADDS     r2,r2,#1              ;114
                  |L1.54|
000036  7813              LDRB     r3,[r2,#0]            ;114
000038  2b0d              CMP      r3,#0xd               ;114
00003a  d006              BEQ      |L1.74|
00003c  2b0a              CMP      r3,#0xa               ;114
00003e  d1f3              BNE      |L1.40|
000040  e003              B        |L1.74|
                  |L1.66|
000042  7016              STRB     r6,[r2,#0]            ;123
000044  b104              CBZ      r4,|L1.72|
000046  b165              CBZ      r5,|L1.98|
                  |L1.72|
000048  1c52              ADDS     r2,r2,#1              ;121
                  |L1.74|
00004a  7813              LDRB     r3,[r2,#0]            ;121
00004c  42ab              CMP      r3,r5                 ;121
00004e  d0f8              BEQ      |L1.66|
000050  2b0d              CMP      r3,#0xd               ;121
000052  d0f6              BEQ      |L1.66|
000054  2b0a              CMP      r3,#0xa               ;121
000056  d0f4              BEQ      |L1.66|
000058  2b21              CMP      r3,#0x21              ;121
00005a  d0f2              BEQ      |L1.66|
                  |L1.92|
00005c  7813              LDRB     r3,[r2,#0]            ;130
00005e  b91b              CBNZ     r3,|L1.104|
000060  e001              B        |L1.102|
                  |L1.98|
000062  1c52              ADDS     r2,r2,#1              ;126
000064  e7fa              B        |L1.92|
                  |L1.102|
000066  2200              MOVS     r2,#0                 ;130
                  |L1.104|
000068  600a              STR      r2,[r1,#0]            ;130
00006a  bd70              POP      {r4-r6,pc}
;;;133    /*****************************************************************************
                          ENDP

                  UART0_IRQHandler PROC
;;;135    *****************************************************************************/
;;;136    void UART0_IRQHandler(void)
00006c  b510              PUSH     {r4,lr}
;;;137    {	
;;;138    	char c;
;;;139    
;;;140    	NVIC_ClearPendingIRQ(UART0_IRQn);
00006e  2005              MOVS     r0,#5
000070  f7fffffe          BL       NVIC_ClearPendingIRQ
;;;141    	c = LPC_UART0->RBR;
000074  48ff              LDR      r0,|L1.1140|
000076  7800              LDRB     r0,[r0,#0]
;;;142    	switch (c)
;;;143    	{
;;;144    		case CNTLQ:         /*ignore Control S/Q*/             
;;;145    		case CNTLS:
;;;146    			break;;
;;;147    
;;;148    		case BACKSPACE:
;;;149    		case DEL:
;;;150    			if (cntUART0 == 0) 
000078  2300              MOVS     r3,#0
;;;151    				break;	
;;;152    			cntUART0--;     /*decrement count*/                
;;;153    			lp--;           /*and line pointer*/               
;;;154    			break;
;;;155    
;;;156    		case ESC:
;;;157    			*lp = 0;        /*ESC - stop editing line*/        
;;;158    			lp = buf_rx;
00007a  4cff              LDR      r4,|L1.1144|
00007c  49ff              LDR      r1,|L1.1148|
00007e  2813              CMP      r0,#0x13              ;142
000080  d028              BEQ      |L1.212|
000082  dc06              BGT      |L1.146|
000084  2808              CMP      r0,#8                 ;142
000086  d00a              BEQ      |L1.158|
000088  280d              CMP      r0,#0xd               ;142
00008a  d014              BEQ      |L1.182|
00008c  2811              CMP      r0,#0x11              ;142
00008e  d11a              BNE      |L1.198|
000090  e020              B        |L1.212|
                  |L1.146|
000092  281b              CMP      r0,#0x1b              ;142
000094  d00b              BEQ      |L1.174|
000096  2821              CMP      r0,#0x21              ;142
000098  d00d              BEQ      |L1.182|
00009a  287f              CMP      r0,#0x7f              ;142
00009c  d113              BNE      |L1.198|
                  |L1.158|
00009e  68ca              LDR      r2,[r1,#0xc]          ;150  ; cntUART0
0000a0  b1da              CBZ      r2,|L1.218|
0000a2  1e52              SUBS     r2,r2,#1              ;152
0000a4  60ca              STR      r2,[r1,#0xc]          ;153  ; cntUART0
0000a6  684a              LDR      r2,[r1,#4]            ;153  ; lp
0000a8  1e52              SUBS     r2,r2,#1              ;153
0000aa  604a              STR      r2,[r1,#4]            ;154  ; lp
0000ac  e012              B        |L1.212|
                  |L1.174|
0000ae  6848              LDR      r0,[r1,#4]            ;157  ; lp
0000b0  7003              STRB     r3,[r0,#0]            ;157
;;;159    			return;
0000b2  604c              STR      r4,[r1,#4]  ; lp
                  |L1.180|
;;;160    
;;;161    		case '!': 
;;;162    		case CR:            /*CR - done, stop editing line*/   
;;;163    			*lp = c;
;;;164    			lp++;           /*increment line pointer*/         
;;;165    			cntUART0++;     /*and count*/                      
;;;166    			c = LF;
;;;167    
;;;168    		default:
;;;169    			*lp = c;
;;;170    			lp++;           /*increment line pointer*/      
;;;171    			cntUART0++; 	/*and count*/                   
;;;172    			break;
;;;173      	}
;;;174    	if((cntUART0 < (sizeof(buf_rx) - 2)  &&  c != LF))  	/*check limit and CR*/           
;;;175    		return;
;;;176    
;;;177    	*lp = 0;								/*mark end of string*/        
;;;178    	rcv = rcv_cmd = RCV_CMD_UART_0;
;;;179    //	NVIC_DisableIRQ(UART2_IRQn);
;;;180    //	NVIC_DisableIRQ(UART0_IRQn);
;;;181    	lp = buf_rx;
;;;182    	cntUART0 = 0;
;;;183    }
0000b4  bd10              POP      {r4,pc}
                  |L1.182|
0000b6  684a              LDR      r2,[r1,#4]            ;163  ; lp
0000b8  f8020b01          STRB     r0,[r2],#1            ;163
0000bc  604a              STR      r2,[r1,#4]            ;165  ; lp
0000be  68c8              LDR      r0,[r1,#0xc]          ;165  ; cntUART0
0000c0  1c40              ADDS     r0,r0,#1              ;165
0000c2  60c8              STR      r0,[r1,#0xc]          ;166  ; cntUART0
0000c4  200a              MOVS     r0,#0xa               ;166
                  |L1.198|
0000c6  684a              LDR      r2,[r1,#4]            ;169  ; lp
0000c8  f8020b01          STRB     r0,[r2],#1            ;169
0000cc  604a              STR      r2,[r1,#4]            ;171  ; lp
0000ce  68ca              LDR      r2,[r1,#0xc]          ;171  ; cntUART0
0000d0  1c52              ADDS     r2,r2,#1              ;171
0000d2  60ca              STR      r2,[r1,#0xc]          ;171  ; cntUART0
                  |L1.212|
0000d4  68ca              LDR      r2,[r1,#0xc]          ;174  ; cntUART0
0000d6  2a9e              CMP      r2,#0x9e              ;174
0000d8  d201              BCS      |L1.222|
                  |L1.218|
0000da  280a              CMP      r0,#0xa               ;174
0000dc  d1ea              BNE      |L1.180|
                  |L1.222|
0000de  6848              LDR      r0,[r1,#4]            ;177  ; lp
0000e0  7003              STRB     r3,[r0,#0]            ;177
0000e2  2001              MOVS     r0,#1                 ;178
0000e4  7008              STRB     r0,[r1,#0]            ;178
0000e6  7048              STRB     r0,[r1,#1]            ;178
0000e8  604c              STR      r4,[r1,#4]            ;182  ; lp
0000ea  60cb              STR      r3,[r1,#0xc]          ;182  ; cntUART0
0000ec  bd10              POP      {r4,pc}
;;;184    /*****************************************************************************
                          ENDP

                  UART2_IRQHandler PROC
;;;186    *****************************************************************************/
;;;187    void UART2_IRQHandler(void)
0000ee  b510              PUSH     {r4,lr}
;;;188    {	
;;;189    	char c;
;;;190    
;;;191    	NVIC_ClearPendingIRQ(UART2_IRQn);
0000f0  2007              MOVS     r0,#7
0000f2  f7fffffe          BL       NVIC_ClearPendingIRQ
;;;192    	c = LPC_UART2->RBR;
0000f6  48e2              LDR      r0,|L1.1152|
0000f8  7800              LDRB     r0,[r0,#0]
;;;193    	switch (c)
;;;194    	{
;;;195    		case CNTLQ:         /*ignore Control S/Q*/             
;;;196    		case CNTLS:
;;;197    			break;;
;;;198    
;;;199    		case BACKSPACE:
;;;200    		case DEL:
;;;201    			if (cntUART2 == 0) 
0000fa  2300              MOVS     r3,#0
;;;202    				break;	
;;;203    			cntUART2--;     /*decrement count*/                
;;;204    			lp--;           /*and line pointer*/               
;;;205    			break;
;;;206    
;;;207    		case ESC:
;;;208    			*lp = 0;        /*ESC - stop editing line*/        
;;;209    			lp = buf_rx;
0000fc  4cde              LDR      r4,|L1.1144|
0000fe  49df              LDR      r1,|L1.1148|
000100  2813              CMP      r0,#0x13              ;193
000102  d028              BEQ      |L1.342|
000104  dc06              BGT      |L1.276|
000106  2808              CMP      r0,#8                 ;193
000108  d00a              BEQ      |L1.288|
00010a  280d              CMP      r0,#0xd               ;193
00010c  d014              BEQ      |L1.312|
00010e  2811              CMP      r0,#0x11              ;193
000110  d11a              BNE      |L1.328|
000112  e020              B        |L1.342|
                  |L1.276|
000114  281b              CMP      r0,#0x1b              ;193
000116  d00b              BEQ      |L1.304|
000118  2821              CMP      r0,#0x21              ;193
00011a  d00d              BEQ      |L1.312|
00011c  287f              CMP      r0,#0x7f              ;193
00011e  d113              BNE      |L1.328|
                  |L1.288|
000120  688a              LDR      r2,[r1,#8]            ;201  ; cntUART2
000122  b1da              CBZ      r2,|L1.348|
000124  1e52              SUBS     r2,r2,#1              ;203
000126  608a              STR      r2,[r1,#8]            ;204  ; cntUART2
000128  684a              LDR      r2,[r1,#4]            ;204  ; lp
00012a  1e52              SUBS     r2,r2,#1              ;204
00012c  604a              STR      r2,[r1,#4]            ;205  ; lp
00012e  e012              B        |L1.342|
                  |L1.304|
000130  6848              LDR      r0,[r1,#4]            ;208  ; lp
000132  7003              STRB     r3,[r0,#0]            ;208
;;;210    			return;
000134  604c              STR      r4,[r1,#4]  ; lp
                  |L1.310|
;;;211    
;;;212    		case '!': 
;;;213    		case CR:            /*CR - done, stop editing line*/   
;;;214    			*lp = c;
;;;215    			lp++;           /*increment line pointer*/         
;;;216    			cntUART2++;     /*and count*/                      
;;;217    			c = LF;
;;;218    
;;;219    		default:
;;;220    			*lp = c;
;;;221    			lp++;           /*increment line pointer*/      
;;;222    			cntUART2++; 	/*and count*/                   
;;;223    			break;
;;;224      	}
;;;225    	if((cntUART2 < (sizeof(buf_rx) - 2)  &&  c != LF))  	/*check limit and CR*/           
;;;226    		return;
;;;227    
;;;228    	*lp = 0;								/*mark end of string*/    
;;;229    	rcv = rcv_cmd = RCV_CMD_UART_2;
;;;230    	
;;;231    //	NVIC_DisableIRQ(UART2_IRQn);
;;;232    //	NVIC_DisableIRQ(UART0_IRQn);
;;;233    	lp = buf_rx;
;;;234    	cntUART2 = 0;
;;;235    }
000136  bd10              POP      {r4,pc}
                  |L1.312|
000138  684a              LDR      r2,[r1,#4]            ;214  ; lp
00013a  f8020b01          STRB     r0,[r2],#1            ;214
00013e  604a              STR      r2,[r1,#4]            ;216  ; lp
000140  6888              LDR      r0,[r1,#8]            ;216  ; cntUART2
000142  1c40              ADDS     r0,r0,#1              ;216
000144  6088              STR      r0,[r1,#8]            ;217  ; cntUART2
000146  200a              MOVS     r0,#0xa               ;217
                  |L1.328|
000148  684a              LDR      r2,[r1,#4]            ;220  ; lp
00014a  f8020b01          STRB     r0,[r2],#1            ;220
00014e  604a              STR      r2,[r1,#4]            ;222  ; lp
000150  688a              LDR      r2,[r1,#8]            ;222  ; cntUART2
000152  1c52              ADDS     r2,r2,#1              ;222
000154  608a              STR      r2,[r1,#8]            ;222  ; cntUART2
                  |L1.342|
000156  688a              LDR      r2,[r1,#8]            ;225  ; cntUART2
000158  2a9e              CMP      r2,#0x9e              ;225
00015a  d201              BCS      |L1.352|
                  |L1.348|
00015c  280a              CMP      r0,#0xa               ;225
00015e  d1ea              BNE      |L1.310|
                  |L1.352|
000160  6848              LDR      r0,[r1,#4]            ;228  ; lp
000162  7003              STRB     r3,[r0,#0]            ;228
000164  2002              MOVS     r0,#2                 ;229
000166  7008              STRB     r0,[r1,#0]            ;229
000168  7048              STRB     r0,[r1,#1]            ;229
00016a  e9c14301          STRD     r4,r3,[r1,#4]         ;229
00016e  bd10              POP      {r4,pc}
;;;236    /*****************************************************************************
                          ENDP

                  init_uart PROC
;;;238    *****************************************************************************/
;;;239    void init_uart (void)
000170  e92d41f0          PUSH     {r4-r8,lr}
;;;240    {
;;;241    	uint16_t usFdiv;
;;;242    
;;;243    	/* UART0 */
;;;244    	LPC_PINCON->PINSEL0 |= (1 << 4);
000174  48c3              LDR      r0,|L1.1156|
000176  6801              LDR      r1,[r0,#0]
000178  f0410110          ORR      r1,r1,#0x10
00017c  6001              STR      r1,[r0,#0]
;;;245    	LPC_PINCON->PINSEL0 |= (1 << 6);	
00017e  6801              LDR      r1,[r0,#0]
000180  f0410140          ORR      r1,r1,#0x40
000184  6001              STR      r1,[r0,#0]
000186  4ac0              LDR      r2,|L1.1160|
;;;246    	LPC_SC->PCONP = LPC_SC->PCONP|(1<<3);	
000188  6811              LDR      r1,[r2,#0]
00018a  f0410108          ORR      r1,r1,#8
00018e  6011              STR      r1,[r2,#0]
;;;247    	LPC_UART0->LCR  = 0x83;
000190  49b8              LDR      r1,|L1.1140|
000192  f04f0683          MOV      r6,#0x83
000196  730e              STRB     r6,[r1,#0xc]
;;;248    	usFdiv = (FPCLK / 16) / UART0_BPS;
;;;249    	LPC_UART0->DLM  = usFdiv / 256;
000198  f04f0300          MOV      r3,#0
00019c  710b              STRB     r3,[r1,#4]
;;;250    	LPC_UART0->DLL  = usFdiv % 256;
00019e  f04f0c0d          MOV      r12,#0xd
0001a2  f881c000          STRB     r12,[r1,#0]
;;;251    	LPC_UART0->LCR  = 0x03;
0001a6  f04f0703          MOV      r7,#3
0001aa  730f              STRB     r7,[r1,#0xc]
;;;252    	LPC_UART0->IER  = 0x01;		
0001ac  f04f0401          MOV      r4,#1
0001b0  604c              STR      r4,[r1,#4]
;;;253    	LPC_UART0->FCR  = 0x06;
0001b2  f04f0506          MOV      r5,#6
0001b6  720d              STRB     r5,[r1,#8]
;;;254    
;;;255    	/* UART2 */
;;;256    	LPC_PINCON->PINSEL0 |= (1 << 20);
0001b8  6801              LDR      r1,[r0,#0]
0001ba  f4411180          ORR      r1,r1,#0x100000
0001be  6001              STR      r1,[r0,#0]
;;;257    	LPC_PINCON->PINSEL0 |= (1 << 22);	
0001c0  6801              LDR      r1,[r0,#0]
0001c2  f4410180          ORR      r1,r1,#0x400000
0001c6  6001              STR      r1,[r0,#0]
;;;258    	LPC_SC->PCONP = LPC_SC->PCONP|(1<<24);
0001c8  6810              LDR      r0,[r2,#0]
0001ca  f0407080          ORR      r0,r0,#0x1000000
0001ce  6010              STR      r0,[r2,#0]
;;;259    	LPC_UART2->LCR  = 0x83;
0001d0  48ab              LDR      r0,|L1.1152|
0001d2  7306              STRB     r6,[r0,#0xc]
;;;260    	usFdiv = (FPCLK / 16) / UART2_BPS;
;;;261    	LPC_UART2->DLM  = usFdiv / 256;
0001d4  7103              STRB     r3,[r0,#4]
;;;262    	LPC_UART2->DLL  = usFdiv % 256;
0001d6  f880c000          STRB     r12,[r0,#0]
;;;263    	LPC_UART2->LCR  = 0x03;
0001da  7307              STRB     r7,[r0,#0xc]
;;;264    	LPC_UART2->IER  = 0x01;		
0001dc  6044              STR      r4,[r0,#4]
;;;265    	LPC_UART2->FCR  = 0x06;
0001de  7205              STRB     r5,[r0,#8]
;;;266    	
;;;267    	lp = buf_rx;
0001e0  48a6              LDR      r0,|L1.1148|
0001e2  49a5              LDR      r1,|L1.1144|
0001e4  e9c01301          STRD     r1,r3,[r0,#4]
;;;268    	cntUART2 = 0;
;;;269    	cntUART0 = 0;
;;;270    	NVIC_EnableIRQ(UART2_IRQn);
0001e8  60c3              STR      r3,[r0,#0xc]  ; cntUART0
0001ea  f04f0007          MOV      r0,#7
0001ee  f7fffffe          BL       NVIC_EnableIRQ
;;;271    	NVIC_EnableIRQ(UART0_IRQn);
0001f2  e8bd41f0          POP      {r4-r8,lr}
0001f6  2005              MOVS     r0,#5
0001f8  f7ffbffe          B.W      NVIC_EnableIRQ
;;;272    }
;;;273    /*****************************************************************************
                          ENDP

                  uart_putChar PROC
;;;275    ******************************************************************************/
;;;276    int uart_putChar (int uart, int c) 
0001fc  b158              CBZ      r0,|L1.534|
;;;277    {
;;;278      	LPC_UART_TypeDef *pUart;
;;;279    
;;;280    	if(uart == 0 || uart == 1)
0001fe  2801              CMP      r0,#1
000200  d009              BEQ      |L1.534|
;;;281    		pUart = (uart == 0) ? (LPC_UART_TypeDef *)LPC_UART0 : (LPC_UART_TypeDef *)LPC_UART1;
;;;282    	else					  
;;;283    		pUart = (uart == 2) ? (LPC_UART_TypeDef *)LPC_UART2 : (LPC_UART_TypeDef *)LPC_UART3;
000202  4a9f              LDR      r2,|L1.1152|
000204  2802              CMP      r0,#2
000206  d000              BEQ      |L1.522|
000208  4aa0              LDR      r2,|L1.1164|
                  |L1.522|
;;;284    	while (!(pUart->LSR & 0x20));
00020a  7d10              LDRB     r0,[r2,#0x14]
00020c  0680              LSLS     r0,r0,#26
00020e  d5fc              BPL      |L1.522|
;;;285      	return (pUart->THR = c);
000210  b2c8              UXTB     r0,r1
000212  7010              STRB     r0,[r2,#0]
;;;286    }
000214  4770              BX       lr
                  |L1.534|
000216  4a97              LDR      r2,|L1.1140|
000218  2800              CMP      r0,#0                 ;281
00021a  d0f6              BEQ      |L1.522|
00021c  4a9c              LDR      r2,|L1.1168|
00021e  e7f4              B        |L1.522|
;;;287    /*****************************************************************************
                          ENDP

                  uart_getChar PROC
;;;289    ******************************************************************************/
;;;290    int uart_getChar (int uart) 
000220  b150              CBZ      r0,|L1.568|
;;;291    {
;;;292      	LPC_UART_TypeDef *pUart;
;;;293    
;;;294    	if(uart == 0 || uart == 1)
000222  2801              CMP      r0,#1
000224  d008              BEQ      |L1.568|
;;;295    		pUart = (uart == 0) ? (LPC_UART_TypeDef *)LPC_UART0 : (LPC_UART_TypeDef *)LPC_UART1;
;;;296    	else					  
;;;297    		pUart = (uart == 2) ? (LPC_UART_TypeDef *)LPC_UART2 : (LPC_UART_TypeDef *)LPC_UART3;
000226  4996              LDR      r1,|L1.1152|
000228  2802              CMP      r0,#2
00022a  d000              BEQ      |L1.558|
00022c  4997              LDR      r1,|L1.1164|
                  |L1.558|
;;;298      	while (!(pUart->LSR & 0x01));
00022e  7d08              LDRB     r0,[r1,#0x14]
000230  07c0              LSLS     r0,r0,#31
000232  d0fc              BEQ      |L1.558|
;;;299      	return (pUart->RBR);
000234  7808              LDRB     r0,[r1,#0]
;;;300    }
000236  4770              BX       lr
                  |L1.568|
000238  498e              LDR      r1,|L1.1140|
00023a  2800              CMP      r0,#0                 ;295
00023c  d0f7              BEQ      |L1.558|
00023e  4994              LDR      r1,|L1.1168|
000240  e7f5              B        |L1.558|
;;;301    /*****************************************************************************
                          ENDP

                  uart_getChar_nb PROC
;;;303    ******************************************************************************/
;;;304    int uart_getChar_nb (int uart) 
000242  b150              CBZ      r0,|L1.602|
;;;305    {
;;;306      	LPC_UART_TypeDef *pUart;
;;;307    
;;;308    	if(uart == 0 || uart == 1)
000244  2801              CMP      r0,#1
000246  d008              BEQ      |L1.602|
;;;309    		pUart = (uart == 0) ? (LPC_UART_TypeDef *)LPC_UART0 : (LPC_UART_TypeDef *)LPC_UART1;
;;;310    	else					  
;;;311    		pUart = (uart == 2) ? (LPC_UART_TypeDef *)LPC_UART2 : (LPC_UART_TypeDef *)LPC_UART3;
000248  498d              LDR      r1,|L1.1152|
00024a  2802              CMP      r0,#2
00024c  d000              BEQ      |L1.592|
00024e  498f              LDR      r1,|L1.1164|
                  |L1.592|
;;;312      	if (pUart->LSR & 0x01)
000250  7d08              LDRB     r0,[r1,#0x14]
000252  07c0              LSLS     r0,r0,#31
000254  d000              BEQ      |L1.600|
;;;313    		return (pUart->RBR);	
000256  7808              LDRB     r0,[r1,#0]
                  |L1.600|
;;;314      	else				  
;;;315    		return 0;  	
;;;316    }
000258  4770              BX       lr
                  |L1.602|
00025a  4986              LDR      r1,|L1.1140|
00025c  2800              CMP      r0,#0                 ;309
00025e  d0f7              BEQ      |L1.592|
000260  498b              LDR      r1,|L1.1168|
000262  e7f5              B        |L1.592|
;;;317    /*****************************************************************************
                          ENDP

                  uart_putString PROC
;;;319    ******************************************************************************/
;;;320    void uart_putString (int uart, char *s) 
000264  b510              PUSH     {r4,lr}
;;;321    {
000266  4604              MOV      r4,r0
000268  460b              MOV      r3,r1
;;;322      	while (*s != 0)
;;;323    	{
;;;324    		uart_putChar(uart,*s++); 
00026a  e003              B        |L1.628|
                  |L1.620|
00026c  1c5b              ADDS     r3,r3,#1
00026e  4620              MOV      r0,r4
000270  f7fffffe          BL       uart_putChar
                  |L1.628|
000274  7819              LDRB     r1,[r3,#0]            ;322
000276  2900              CMP      r1,#0                 ;322
000278  d1f8              BNE      |L1.620|
;;;325    	}
;;;326    }
00027a  bd10              POP      {r4,pc}
;;;327    
                          ENDP

                  cmd_reset_board PROC
;;;331    ******************************************************************************/
;;;332    void cmd_reset_board (char *par) 
00027c  f04f4080          MOV      r0,#0x40000000
;;;333    {
;;;334    	LPC_WDT->WDTC = 0x003FFFF;	/*0.5s*/
000280  4984              LDR      r1,|L1.1172|
000282  6041              STR      r1,[r0,#4]
;;;335    	wdt_feed();
000284  f04f01aa          MOV      r1,#0xaa
000288  7201              STRB     r1,[r0,#8]
00028a  f04f0155          MOV      r1,#0x55
00028e  7201              STRB     r1,[r0,#8]
                  |L1.656|
;;;336    	while(1);
000290  e7fe              B        |L1.656|
;;;337    } 
;;;338    /*****************************************************************************
                          ENDP

                  cmd_ar_swing PROC
;;;340    *****************************************************************************/
;;;341    void cmd_ar_swing (char *par) 
000292  b570              PUSH     {r4-r6,lr}
;;;342    {
000294  4606              MOV      r6,r0
;;;343    	char currentCfg = atoi(cfg.file.mode_func_ar); 
000296  4880              LDR      r0,|L1.1176|
000298  4605              MOV      r5,r0
00029a  f7fffffe          BL       atoi
00029e  b2c4              UXTB     r4,r0
;;;344    
;;;345    	if(par[0] == '1')
0002a0  7830              LDRB     r0,[r6,#0]
;;;346    	{
;;;347    		ir_state.bit.ArSwing = __TRUE;
0002a2  497e              LDR      r1,|L1.1180|
0002a4  2831              CMP      r0,#0x31              ;345
0002a6  d006              BEQ      |L1.694|
;;;348    		sprintf(buf_tx,"SWI %u",ir_state.bit.ArSwing);
;;;349    
;;;350    	}else 
;;;351    	if(par[0] == '0')
0002a8  2830              CMP      r0,#0x30
0002aa  d008              BEQ      |L1.702|
;;;352    	{
;;;353    		ir_state.bit.ArSwing = __FALSE;
;;;354    		sprintf(buf_tx,"SWI %u",ir_state.bit.ArSwing);
;;;355    
;;;356    	}else 
;;;357    	if(par[0] == '2')
0002ac  2832              CMP      r0,#0x32
0002ae  d00e              BEQ      |L1.718|
;;;358    	{
;;;359    		memset(buf_tx,0,sizeof(buf_tx));
;;;360    		if(par[1] == '0')
;;;361    			strcpy(cfg.file.mode_func_ar,"0\0");
;;;362    		else 
;;;363    		if(par[1] == '1')
;;;364    			strcpy(cfg.file.mode_func_ar,"1\0");	 
;;;365    		else 
;;;366    		if(par[1] == '?')
;;;367    			sprintf(buf_tx,"SWI 2%u",atoi(cfg.file.mode_func_ar));
;;;368    		else
;;;369    			sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);
;;;370    
;;;371    		if(currentCfg != atoi(cfg.file.mode_func_ar)) 
;;;372    			fwrite_line(cfg.file.mode_func_ar, FILE_CFG_CFG, LINE_MODE_FUNC_AR);
;;;373    		
;;;374    		if(!buf_tx[0])	
;;;375    			sprintf(buf_tx,"SWI 2%u",atoi(cfg.file.mode_func_ar));
;;;376    	}else
;;;377    		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);		
0002b0  2207              MOVS     r2,#7
0002b2  a17b              ADR      r1,|L1.1184|
0002b4  e031              B        |L1.794|
                  |L1.694|
0002b6  7808              LDRB     r0,[r1,#0]            ;347  ; ir_state
0002b8  f0400020          ORR      r0,r0,#0x20           ;347
0002bc  e002              B        |L1.708|
                  |L1.702|
0002be  7808              LDRB     r0,[r1,#0]            ;353  ; ir_state
0002c0  f0200020          BIC      r0,r0,#0x20           ;353
                  |L1.708|
0002c4  7008              STRB     r0,[r1,#0]            ;347
0002c6  f3c01240          UBFX     r2,r0,#5,#1           ;348
0002ca  a178              ADR      r1,|L1.1196|
0002cc  e025              B        |L1.794|
                  |L1.718|
0002ce  486a              LDR      r0,|L1.1144|
0002d0  21a0              MOVS     r1,#0xa0              ;359
0002d2  38a0              SUBS     r0,r0,#0xa0           ;359
0002d4  f7fffffe          BL       __aeabi_memclr
0002d8  7870              LDRB     r0,[r6,#1]            ;360
0002da  2830              CMP      r0,#0x30              ;360
0002dc  d023              BEQ      |L1.806|
0002de  2831              CMP      r0,#0x31              ;363
0002e0  d025              BEQ      |L1.814|
0002e2  283f              CMP      r0,#0x3f              ;366
0002e4  d02a              BEQ      |L1.828|
0002e6  2207              MOVS     r2,#7                 ;369
0002e8  a16d              ADR      r1,|L1.1184|
                  |L1.746|
0002ea  4863              LDR      r0,|L1.1144|
0002ec  38a0              SUBS     r0,r0,#0xa0           ;367
0002ee  f7fffffe          BL       __2sprintf
                  |L1.754|
0002f2  4628              MOV      r0,r5                 ;367
0002f4  f7fffffe          BL       atoi
0002f8  42a0              CMP      r0,r4                 ;371
0002fa  d004              BEQ      |L1.774|
0002fc  2200              MOVS     r2,#0                 ;372
0002fe  a16d              ADR      r1,|L1.1204|
000300  4628              MOV      r0,r5                 ;372
000302  f7fffffe          BL       fwrite_line
                  |L1.774|
000306  485c              LDR      r0,|L1.1144|
000308  38a0              SUBS     r0,r0,#0xa0           ;374
00030a  7800              LDRB     r0,[r0,#0]            ;374  ; buf_tx
00030c  2800              CMP      r0,#0                 ;374
00030e  d11b              BNE      |L1.840|
000310  4628              MOV      r0,r5                 ;374
000312  f7fffffe          BL       atoi
000316  4602              MOV      r2,r0                 ;375
000318  a169              ADR      r1,|L1.1216|
                  |L1.794|
00031a  e8bd4070          POP      {r4-r6,lr}
00031e  4856              LDR      r0,|L1.1144|
000320  38a0              SUBS     r0,r0,#0xa0
000322  f7ffbffe          B.W      __2sprintf
                  |L1.806|
000326  485c              LDR      r0,|L1.1176|
000328  a167              ADR      r1,|L1.1224|
00032a  3888              SUBS     r0,r0,#0x88           ;361
00032c  e002              B        |L1.820|
                  |L1.814|
00032e  485a              LDR      r0,|L1.1176|
000330  a166              ADR      r1,|L1.1228|
000332  3888              SUBS     r0,r0,#0x88           ;364
                  |L1.820|
000334  8809              LDRH     r1,[r1,#0]            ;364
000336  f8a01088          STRH     r1,[r0,#0x88]         ;364
00033a  e7da              B        |L1.754|
                  |L1.828|
00033c  4628              MOV      r0,r5                 ;364
00033e  f7fffffe          BL       atoi
000342  4602              MOV      r2,r0                 ;367
000344  a15e              ADR      r1,|L1.1216|
000346  e7d0              B        |L1.746|
                  |L1.840|
;;;378    }
000348  bd70              POP      {r4-r6,pc}
;;;379    
                          ENDP

                  cmd_detect_swing PROC
;;;382    *****************************************************************************/
;;;383    void cmd_detect_swing(char *par)
00034a  e92d5ff0          PUSH     {r4-r12,lr}
;;;384    {
;;;385    	U16 j,n_acertos,n_pulse;
;;;386    
;;;387    	memset(ir_cmp,0xffff,sizeof(ir_cmp));
00034e  f64f77ff          MOV      r7,#0xffff
000352  f44f7448          MOV      r4,#0x320
000356  463a              MOV      r2,r7
000358  4621              MOV      r1,r4
00035a  485d              LDR      r0,|L1.1232|
00035c  f7fffffe          BL       __aeabi_memset
;;;388    	memcpy(ir_cmp,ir,sizeof(ir_cmp));
000360  4622              MOV      r2,r4
000362  495c              LDR      r1,|L1.1236|
000364  485a              LDR      r0,|L1.1232|
000366  f7fffffe          BL       __aeabi_memcpy
;;;389    
;;;390    	cmd_ir_learn_app("0");	
00036a  a057              ADR      r0,|L1.1224|
00036c  f7fffffe          BL       cmd_ir_learn_app
;;;391    	if(buf_tx[0] == 'E')
000370  4841              LDR      r0,|L1.1144|
000372  38a0              SUBS     r0,r0,#0xa0
000374  7800              LDRB     r0,[r0,#0]  ; buf_tx
000376  2845              CMP      r0,#0x45
000378  d063              BEQ      |L1.1090|
;;;392    		return;
;;;393    
;;;394    	for(j=0, n_acertos=0, n_pulse=0;j<MAX_QTD_PULSOS;j++)
00037a  2400              MOVS     r4,#0
00037c  f8dfb150          LDR      r11,|L1.1232|
000380  f8dfa150          LDR      r10,|L1.1236|
000384  4625              MOV      r5,r4
000386  4626              MOV      r6,r4
                  |L1.904|
;;;395    	{
;;;396    		if(ir_cmp[j] == 0xffff || ir_cmp[j] < 0x10)
000388  f83b0014          LDRH     r0,[r11,r4,LSL #1]
00038c  f5a0427f          SUB      r2,r0,#0xff00
000390  4681              MOV      r9,r0
000392  3aff              SUBS     r2,r2,#0xff
000394  d03e              BEQ      |L1.1044|
000396  f1b90f10          CMP      r9,#0x10
00039a  d33b              BCC      |L1.1044|
;;;397    			break;
;;;398    
;;;399    		n_pulse++;
00039c  1c76              ADDS     r6,r6,#1
00039e  b2b6              UXTH     r6,r6
;;;400    		if(ir_cmp[j] >= (ir[j] - ((float)ir[j] * 0.3)) && ir_cmp[j] <= (ir[j] + ((float)ir[j] * 0.3)))	/*Cada pulso está dentro do range de 30%?*/
0003a0  f83a0014          LDRH     r0,[r10,r4,LSL #1]
0003a4  f7fffffe          BL       __aeabi_ui2d
0003a8  4607              MOV      r7,r0
0003aa  4688              MOV      r8,r1
0003ac  f04f3233          MOV      r2,#0x33333333
0003b0  4b49              LDR      r3,|L1.1240|
0003b2  f7fffffe          BL       __aeabi_dmul
0003b6  463a              MOV      r2,r7
0003b8  4643              MOV      r3,r8
0003ba  f7fffffe          BL       __aeabi_drsub
0003be  4607              MOV      r7,r0
0003c0  4688              MOV      r8,r1
0003c2  4648              MOV      r0,r9
0003c4  f7fffffe          BL       __aeabi_ui2d
0003c8  463a              MOV      r2,r7
0003ca  4643              MOV      r3,r8
0003cc  f7fffffe          BL       __aeabi_cdrcmple
0003d0  d81b              BHI      |L1.1034|
0003d2  f83a0014          LDRH     r0,[r10,r4,LSL #1]
0003d6  f7fffffe          BL       __aeabi_ui2d
0003da  4607              MOV      r7,r0
0003dc  4688              MOV      r8,r1
0003de  f04f3233          MOV      r2,#0x33333333
0003e2  4b3d              LDR      r3,|L1.1240|
0003e4  f7fffffe          BL       __aeabi_dmul
0003e8  463a              MOV      r2,r7
0003ea  4643              MOV      r3,r8
0003ec  f7fffffe          BL       __aeabi_dadd
0003f0  4607              MOV      r7,r0
0003f2  4688              MOV      r8,r1
0003f4  f83b0014          LDRH     r0,[r11,r4,LSL #1]
0003f8  f7fffffe          BL       __aeabi_ui2d
0003fc  463a              MOV      r2,r7
0003fe  4643              MOV      r3,r8
000400  f7fffffe          BL       __aeabi_cdcmple
000404  d801              BHI      |L1.1034|
;;;401    			n_acertos++;		
000406  1c6d              ADDS     r5,r5,#1
000408  b2ad              UXTH     r5,r5
                  |L1.1034|
00040a  1c64              ADDS     r4,r4,#1              ;394
00040c  b2a4              UXTH     r4,r4                 ;394
00040e  f5b47fc8          CMP      r4,#0x190             ;394
000412  d3b9              BCC      |L1.904|
                  |L1.1044|
;;;402    	}
;;;403    
;;;404    	printf("[SWING %s...Acertos:%u...All pulse:%u]\r\r",(n_acertos == n_pulse) ? "OUT" : "IN", n_acertos,n_pulse);
000414  a131              ADR      r1,|L1.1244|
000416  42b5              CMP      r5,r6
000418  d000              BEQ      |L1.1052|
00041a  a131              ADR      r1,|L1.1248|
                  |L1.1052|
00041c  4633              MOV      r3,r6
00041e  462a              MOV      r2,r5
000420  a030              ADR      r0,|L1.1252|
000422  f7fffffe          BL       __2printf
;;;405    	fflush(stdout);
000426  483a              LDR      r0,|L1.1296|
000428  f7fffffe          BL       fflush
;;;406    
;;;407    	if(n_acertos == n_pulse)
00042c  42b5              CMP      r5,r6
00042e  d101              BNE      |L1.1076|
;;;408    		sprintf(buf_tx,"OK 1");	/*Ar condicionado do tipo swing out*/	
000430  a138              ADR      r1,|L1.1300|
000432  e000              B        |L1.1078|
                  |L1.1076|
;;;409    	else
;;;410    		sprintf(buf_tx,"OK 0");	/*Ar condicionado do tipo swing in*/	
000434  a139              ADR      r1,|L1.1308|
                  |L1.1078|
000436  e8bd5ff0          POP      {r4-r12,lr}
00043a  480f              LDR      r0,|L1.1144|
00043c  38a0              SUBS     r0,r0,#0xa0
00043e  f7ffbffe          B.W      __2sprintf
                  |L1.1090|
;;;411    }
000442  e8bd9ff0          POP      {r4-r12,pc}
;;;412    
                          ENDP

                  cmd_type_dim PROC
;;;463    *****************************************************************************/
;;;464    void cmd_type_dim(char *par)
000446  b530              PUSH     {r4,r5,lr}
;;;465    {
000448  b087              SUB      sp,sp,#0x1c
00044a  4604              MOV      r4,r0
;;;466    	char str[20], cfg = __FALSE;
;;;467    
;;;468    	memset(str,0,sizeof(str));
00044c  2114              MOVS     r1,#0x14
00044e  a801              ADD      r0,sp,#4
000450  f7fffffe          BL       __aeabi_memclr4
;;;469    	switch(par[0])
000454  7820              LDRB     r0,[r4,#0]
000456  2830              CMP      r0,#0x30
000458  d066              BEQ      |L1.1320|
00045a  2831              CMP      r0,#0x31
00045c  d07e              BEQ      |L1.1372|
00045e  2832              CMP      r0,#0x32
000460  d07d              BEQ      |L1.1374|
000462  283f              CMP      r0,#0x3f
000464  d07c              BEQ      |L1.1376|
;;;470    	{	/*TDI 00 (Dimmer 0 On/Off) ou TDI 01 (Dimmer 0 Dimerizável)*/
;;;471    		case '0':	strcpy(str, par[1] == '1' ? "1\0" : "0\0"); 
;;;472    					fwrite_line(str, FILE_CFG_CFG, LINE_TYPE_DIM0);
;;;473    					strcpy(type_dim0,str);
;;;474    					strcpy(str, par[1] == '1' ? "TDI 01\0" : "TDI 00\0"); 
;;;475    					cfg = __TRUE; 
;;;476    					break;
;;;477    
;;;478    		/*TDI 10 (Dimmer 1 On/Off) ou TDI 11 (Dimmer 1 Dimerizável)*/
;;;479    		case '1':	strcpy(str, par[1] == '1' ? "1\0" : "0\0"); 
;;;480    					fwrite_line(str, FILE_CFG_CFG, LINE_TYPE_DIM1);
;;;481    					strcpy(type_dim1,str);
;;;482    					strcpy(str, par[1] == '1' ? "TDI 11\0" : "TDI 10\0");
;;;483    					cfg = __TRUE; 
;;;484    					break;
;;;485    
;;;486    		/*TDI 20 (Dimmer 2 On/Off) ou TDI 21 (Dimmer 2 Dimerizável)*/
;;;487    		case '2':	strcpy(str, par[1] == '1' ? "1\0" : "0\0"); 
;;;488    					fwrite_line(str, FILE_CFG_CFG, LINE_TYPE_DIM2);
;;;489    					strcpy(type_dim2,str);
;;;490    					strcpy(str, par[1] == '1' ? "TDI 21\0" : "TDI 20\0");
;;;491    					cfg = __TRUE; 
;;;492    					break;
;;;493    
;;;494    		case '?':	sprintf(buf_tx,"TDI %u %u %u", atoi(type_dim0), atoi(type_dim1), atoi(type_dim2)); 
;;;495    					if(rcv_cmd == RCV_CMD_UART_2)
;;;496    					{
;;;497    						uart_putString(UART_LINK_LPC,buf_tx);
;;;498    						uart_putString(UART_LINK_LPC,"!\0");
;;;499    					}		
;;;500    					break;
;;;501    		
;;;502    		default:	sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);
000466  4804              LDR      r0,|L1.1144|
000468  2207              MOVS     r2,#7
00046a  a10d              ADR      r1,|L1.1184|
00046c  38a0              SUBS     r0,r0,#0xa0
00046e  f7fffffe          BL       __2sprintf
                  |L1.1138|
;;;503    					return;
;;;504    	}
;;;505    
;;;506    	if(cfg)
;;;507    	{
;;;508    		uart_putString(UART_LINK_LPC,str);
;;;509    		uart_putString(UART_LINK_LPC,"!\0");
;;;510    		sprintf(buf_tx,"OK"); 
;;;511    	}
;;;512    
;;;513    	printf("[Type Dimmer's config: 0:%s..1:%s..2:%s]\r",atoi(type_dim0) ? "DIMMER":"ONOFF", 
;;;514    		atoi(type_dim1) ? "DIMMER":"ONOFF", 
;;;515    		atoi(type_dim2) ? "DIMMER":"ONOFF");
;;;516    
;;;517    	fflush(stdout);
;;;518    }
000472  e057              B        |L1.1316|
                  |L1.1140|
                          DCD      0x4000c000
                  |L1.1144|
                          DCD      ||.bss||+0xa0
                  |L1.1148|
                          DCD      ||.data||
                  |L1.1152|
                          DCD      0x40098000
                  |L1.1156|
                          DCD      0x4002c000
                  |L1.1160|
                          DCD      0x400fc0c4
                  |L1.1164|
                          DCD      0x4009c000
                  |L1.1168|
                          DCD      0x40010000
                  |L1.1172|
                          DCD      0x0003ffff
                  |L1.1176|
                          DCD      ||cfg||+0x88
                  |L1.1180|
                          DCD      ir_state
                  |L1.1184|
0004a0  4552524f          DCB      "ERROR %u",0
0004a4  52202575
0004a8  00      
0004a9  00                DCB      0
0004aa  00                DCB      0
0004ab  00                DCB      0
                  |L1.1196|
0004ac  53574920          DCB      "SWI "
                  |L1.1200|
0004b0  257500            DCB      "%u",0
0004b3  00                DCB      0
                  |L1.1204|
0004b4  6366672e          DCB      "cfg.cfg",0
0004b8  63666700
0004bc  00                DCB      0
0004bd  00                DCB      0
0004be  00                DCB      0
0004bf  00                DCB      0
                  |L1.1216|
0004c0  53574920          DCB      "SWI 2%u",0
0004c4  32257500
                  |L1.1224|
0004c8  3000              DCB      "0",0
0004ca  00                DCB      0
0004cb  00                DCB      0
                  |L1.1228|
0004cc  3100              DCB      "1",0
0004ce  00                DCB      0
0004cf  00                DCB      0
                  |L1.1232|
                          DCD      ir_cmp
                  |L1.1236|
                          DCD      ||ir||
                  |L1.1240|
                          DCD      0x3fd33333
                  |L1.1244|
0004dc  4f555400          DCB      "OUT",0
                  |L1.1248|
0004e0  494e00            DCB      "IN",0
0004e3  00                DCB      0
                  |L1.1252|
0004e4  5b535749          DCB      "[SWING %s...Acertos:%u...All pulse:%u]\r\r",0
0004e8  4e472025
0004ec  732e2e2e
0004f0  41636572
0004f4  746f733a
0004f8  25752e2e
0004fc  2e416c6c
000500  2070756c
000504  73653a25
000508  755d0d0d
00050c  00      
00050d  00                DCB      0
00050e  00                DCB      0
00050f  00                DCB      0
                  |L1.1296|
                          DCD      __stdout
                  |L1.1300|
000514  4f4b2031          DCB      "OK 1",0
000518  00      
000519  00                DCB      0
00051a  00                DCB      0
00051b  00                DCB      0
                  |L1.1308|
00051c  4f4b2030          DCB      "OK 0",0
000520  00      
000521  00                DCB      0
000522  00                DCB      0
000523  00                DCB      0
                  |L1.1316|
000524  b007              ADD      sp,sp,#0x1c
000526  bd30              POP      {r4,r5,pc}
                  |L1.1320|
000528  f2af0160          ADR      r1,|L1.1228|
00052c  7860              LDRB     r0,[r4,#1]            ;471
00052e  2831              CMP      r0,#0x31              ;471
000530  d001              BEQ      |L1.1334|
000532  f2af016c          ADR      r1,|L1.1224|
                  |L1.1334|
000536  a801              ADD      r0,sp,#4              ;471
000538  f7fffffe          BL       strcpy
00053c  2202              MOVS     r2,#2                 ;472
00053e  f2af018c          ADR      r1,|L1.1204|
000542  a801              ADD      r0,sp,#4              ;472
000544  f7fffffe          BL       fwrite_line
000548  a901              ADD      r1,sp,#4              ;473
00054a  48fd              LDR      r0,|L1.2368|
00054c  f7fffffe          BL       strcpy
000550  7860              LDRB     r0,[r4,#1]            ;474
000552  a1fc              ADR      r1,|L1.2372|
000554  2831              CMP      r0,#0x31              ;474
000556  d000              BEQ      |L1.1370|
000558  a1fc              ADR      r1,|L1.2380|
                  |L1.1370|
00055a  e002              B        |L1.1378|
                  |L1.1372|
00055c  e011              B        |L1.1410|
                  |L1.1374|
00055e  e02a              B        |L1.1462|
                  |L1.1376|
000560  e043              B        |L1.1514|
                  |L1.1378|
000562  a801              ADD      r0,sp,#4              ;474
000564  f7fffffe          BL       strcpy
000568  a901              ADD      r1,sp,#4              ;508
00056a  2002              MOVS     r0,#2                 ;508
00056c  f7fffffe          BL       uart_putString
000570  a1f8              ADR      r1,|L1.2388|
000572  2002              MOVS     r0,#2                 ;509
000574  f7fffffe          BL       uart_putString
000578  a1f7              ADR      r1,|L1.2392|
00057a  48f8              LDR      r0,|L1.2396|
00057c  f7fffffe          BL       __2sprintf
000580  e050              B        |L1.1572|
                  |L1.1410|
000582  f2af01b8          ADR      r1,|L1.1228|
000586  7860              LDRB     r0,[r4,#1]            ;479
000588  2831              CMP      r0,#0x31              ;479
00058a  d001              BEQ      |L1.1424|
00058c  f2af01c8          ADR      r1,|L1.1224|
                  |L1.1424|
000590  a801              ADD      r0,sp,#4              ;479
000592  f7fffffe          BL       strcpy
000596  2203              MOVS     r2,#3                 ;480
000598  f2af01e8          ADR      r1,|L1.1204|
00059c  a801              ADD      r0,sp,#4              ;480
00059e  f7fffffe          BL       fwrite_line
0005a2  a901              ADD      r1,sp,#4              ;481
0005a4  48ee              LDR      r0,|L1.2400|
0005a6  f7fffffe          BL       strcpy
0005aa  7860              LDRB     r0,[r4,#1]            ;482
0005ac  a1ed              ADR      r1,|L1.2404|
0005ae  2831              CMP      r0,#0x31              ;482
0005b0  d0d3              BEQ      |L1.1370|
0005b2  a1ee              ADR      r1,|L1.2412|
0005b4  e7d1              B        |L1.1370|
                  |L1.1462|
0005b6  f2af01ec          ADR      r1,|L1.1228|
0005ba  7860              LDRB     r0,[r4,#1]            ;487
0005bc  2831              CMP      r0,#0x31              ;487
0005be  d001              BEQ      |L1.1476|
0005c0  f2af01fc          ADR      r1,|L1.1224|
                  |L1.1476|
0005c4  a801              ADD      r0,sp,#4              ;487
0005c6  f7fffffe          BL       strcpy
0005ca  2204              MOVS     r2,#4                 ;488
0005cc  f2af111c          ADR      r1,|L1.1204|
0005d0  a801              ADD      r0,sp,#4              ;488
0005d2  f7fffffe          BL       fwrite_line
0005d6  a901              ADD      r1,sp,#4              ;489
0005d8  48e6              LDR      r0,|L1.2420|
0005da  f7fffffe          BL       strcpy
0005de  7860              LDRB     r0,[r4,#1]            ;490
0005e0  a1e5              ADR      r1,|L1.2424|
0005e2  2831              CMP      r0,#0x31              ;490
0005e4  d0b9              BEQ      |L1.1370|
0005e6  a1e6              ADR      r1,|L1.2432|
0005e8  e7b7              B        |L1.1370|
                  |L1.1514|
0005ea  48e2              LDR      r0,|L1.2420|
0005ec  f7fffffe          BL       atoi
0005f0  4604              MOV      r4,r0                 ;494
0005f2  48db              LDR      r0,|L1.2400|
0005f4  f7fffffe          BL       atoi
0005f8  4605              MOV      r5,r0                 ;494
0005fa  48d1              LDR      r0,|L1.2368|
0005fc  f7fffffe          BL       atoi
000600  4602              MOV      r2,r0                 ;494
000602  462b              MOV      r3,r5                 ;494
000604  a1e0              ADR      r1,|L1.2440|
000606  48d5              LDR      r0,|L1.2396|
000608  9400              STR      r4,[sp,#0]            ;494
00060a  f7fffffe          BL       __2sprintf
00060e  48e2              LDR      r0,|L1.2456|
000610  7800              LDRB     r0,[r0,#0]            ;495  ; rcv_cmd
000612  2802              CMP      r0,#2                 ;495
000614  d106              BNE      |L1.1572|
000616  49d1              LDR      r1,|L1.2396|
000618  f7fffffe          BL       uart_putString
00061c  a1cd              ADR      r1,|L1.2388|
00061e  2002              MOVS     r0,#2                 ;498
000620  f7fffffe          BL       uart_putString
                  |L1.1572|
000624  48d3              LDR      r0,|L1.2420|
000626  f7fffffe          BL       atoi
00062a  b108              CBZ      r0,|L1.1584|
00062c  a4db              ADR      r4,|L1.2460|
00062e  e000              B        |L1.1586|
                  |L1.1584|
000630  a4dc              ADR      r4,|L1.2468|
                  |L1.1586|
000632  48cb              LDR      r0,|L1.2400|
000634  f7fffffe          BL       atoi
000638  b108              CBZ      r0,|L1.1598|
00063a  a5d8              ADR      r5,|L1.2460|
00063c  e000              B        |L1.1600|
                  |L1.1598|
00063e  a5d9              ADR      r5,|L1.2468|
                  |L1.1600|
000640  48bf              LDR      r0,|L1.2368|
000642  f7fffffe          BL       atoi
000646  b108              CBZ      r0,|L1.1612|
000648  a1d4              ADR      r1,|L1.2460|
00064a  e000              B        |L1.1614|
                  |L1.1612|
00064c  a1d5              ADR      r1,|L1.2468|
                  |L1.1614|
00064e  4623              MOV      r3,r4                 ;513
000650  462a              MOV      r2,r5                 ;513
000652  a0d6              ADR      r0,|L1.2476|
000654  f7fffffe          BL       __2printf
000658  48df              LDR      r0,|L1.2520|
00065a  f7fffffe          BL       fflush
00065e  e708              B        |L1.1138|
;;;519    
                          ENDP

                  ena_dis_touch PROC
;;;522    *****************************************************************************/
;;;523    void ena_dis_touch(void)
000660  b500              PUSH     {lr}
;;;524    {
;;;525    	char str[20];
;;;526    
;;;527    	sprintf(str,"%u\0",touchEnaDis);
000662  48de              LDR      r0,|L1.2524|
000664  b085              SUB      sp,sp,#0x14           ;524
000666  f2af11b8          ADR      r1,|L1.1200|
00066a  6802              LDR      r2,[r0,#0]  ; touchEnaDis
00066c  4668              MOV      r0,sp
00066e  f7fffffe          BL       __2sprintf
;;;528    	fwrite_line(str, FILE_CFG_CFG, LINE_ENA_DIS_TOUCH);
000672  2205              MOVS     r2,#5
000674  f2af11c4          ADR      r1,|L1.1204|
000678  4668              MOV      r0,sp
00067a  f7fffffe          BL       fwrite_line
;;;529    	sprintf(buf_tx,"OK");
00067e  a1b6              ADR      r1,|L1.2392|
000680  48b6              LDR      r0,|L1.2396|
000682  f7fffffe          BL       __2sprintf
;;;530    }
000686  b005              ADD      sp,sp,#0x14
000688  bd00              POP      {pc}
;;;531     
                          ENDP

                  cmd_enable_touch PROC
;;;534    *****************************************************************************/
;;;535    void cmd_enable_touch(char *par)
00068a  b570              PUSH     {r4-r6,lr}
;;;536    {
00068c  4604              MOV      r4,r0
;;;537    	if(atoi(par) < QTD_OUTS && par[0])
00068e  f7fffffe          BL       atoi
000692  2818              CMP      r0,#0x18
000694  da16              BGE      |L1.1732|
000696  7821              LDRB     r1,[r4,#0]
000698  b1a1              CBZ      r1,|L1.1732|
;;;538    	{
;;;539    		if(par[0] == '?')
;;;540    		{
;;;541    			sprintf(buf_tx,"ENT %u\0",touchEnaDis);	
00069a  4dd0              LDR      r5,|L1.2524|
00069c  293f              CMP      r1,#0x3f              ;539
00069e  d00a              BEQ      |L1.1718|
;;;542    			return;
;;;543    		}
;;;544    		touchEnaDis |= (1 << atoi(par));
0006a0  4620              MOV      r0,r4
0006a2  f7fffffe          BL       atoi
0006a6  2101              MOVS     r1,#1
0006a8  4081              LSLS     r1,r1,r0
0006aa  6828              LDR      r0,[r5,#0]  ; touchEnaDis
0006ac  4301              ORRS     r1,r1,r0
;;;545    		ena_dis_touch();
0006ae  6029              STR      r1,[r5,#0]  ; touchEnaDis
0006b0  e8bd4070          POP      {r4-r6,lr}
0006b4  e7fe              B        ena_dis_touch
                  |L1.1718|
0006b6  682a              LDR      r2,[r5,#0]            ;541  ; touchEnaDis
0006b8  a1c9              ADR      r1,|L1.2528|
                  |L1.1722|
;;;546    	}else
;;;547    		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);	
0006ba  e8bd4070          POP      {r4-r6,lr}
0006be  48a7              LDR      r0,|L1.2396|
0006c0  f7ffbffe          B.W      __2sprintf
                  |L1.1732|
0006c4  2207              MOVS     r2,#7
0006c6  f2af2128          ADR      r1,|L1.1184|
0006ca  e7f6              B        |L1.1722|
;;;548    }
;;;549    
                          ENDP

                  cmd_disable_touch PROC
;;;552    *****************************************************************************/
;;;553    void cmd_disable_touch(char *par)
0006cc  b510              PUSH     {r4,lr}
;;;554    {
0006ce  4604              MOV      r4,r0
;;;555    	if(atoi(par) < QTD_OUTS && par[0])
0006d0  f7fffffe          BL       atoi
0006d4  2818              CMP      r0,#0x18
0006d6  da0d              BGE      |L1.1780|
0006d8  7820              LDRB     r0,[r4,#0]
0006da  b158              CBZ      r0,|L1.1780|
;;;556    	{
;;;557    		touchEnaDis &= ~(1 << atoi(par));
0006dc  4620              MOV      r0,r4
0006de  f7fffffe          BL       atoi
0006e2  2101              MOVS     r1,#1
0006e4  4081              LSLS     r1,r1,r0
0006e6  48bd              LDR      r0,|L1.2524|
0006e8  6802              LDR      r2,[r0,#0]  ; touchEnaDis
0006ea  438a              BICS     r2,r2,r1
;;;558    		ena_dis_touch();
0006ec  6002              STR      r2,[r0,#0]  ; touchEnaDis
0006ee  e8bd4010          POP      {r4,lr}
0006f2  e7fe              B        ena_dis_touch
                  |L1.1780|
;;;559    	}else
;;;560    		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);	
0006f4  2207              MOVS     r2,#7
0006f6  f2af2158          ADR      r1,|L1.1184|
0006fa  e8bd4010          POP      {r4,lr}
0006fe  4897              LDR      r0,|L1.2396|
000700  f7ffbffe          B.W      __2sprintf
;;;561    }
;;;562    
                          ENDP

                  cmd_set_real_time PROC
;;;565    *****************************************************************************/
;;;566    void cmd_set_real_time(char *par) 
000704  b510              PUSH     {r4,lr}
;;;567    {
000706  b088              SUB      sp,sp,#0x20
000708  4604              MOV      r4,r0
;;;568    /*
;;;569    	exemplo "SET 100.........!"	 //Configura apenas a porcentagem do dimmer 0
;;;570    	exemplo "SET ...100......!"	 //Configura apenas a porcentagem do dimmer 1
;;;571    	exemplo "SET ......100...!"	 //Configura apenas a porcentagem do dimmer 2
;;;572    
;;;573    	exemplo "SET .........1..!"	 //Configura apenas o rele 0 (Liga)
;;;574    	exemplo "SET .........0..!"	 //Configura apenas o rele 0 (Desliga)
;;;575    	exemplo "SET ..........1.!"	 //Configura apenas o rele 1 (Liga)
;;;576    	exemplo "SET ..........0.!"	 //Configura apenas o rele 1 (Desliga)
;;;577    	exemplo "SET ...........1!"	 //Configura apenas o rele 2 (Liga)
;;;578    	exemplo "SET ...........0!"	 //Configura apenas o rele 2 (Desliga)
;;;579    */
;;;580    
;;;581    	char str[30],i;
;;;582    
;;;583    	memset(str,0,sizeof(str));
00070a  2120              MOVS     r1,#0x20
00070c  4668              MOV      r0,sp
00070e  f7fffffe          BL       __aeabi_memclr4
;;;584    	strcat(str,"SET ");
000712  a1b5              ADR      r1,|L1.2536|
000714  4668              MOV      r0,sp
000716  f7fffffe          BL       strcat
;;;585    	strcat(str,par);
00071a  4621              MOV      r1,r4
00071c  4668              MOV      r0,sp
00071e  f7fffffe          BL       strcat
;;;586    
;;;587    	for(i=0;i<sizeof(str);i++)
000722  2000              MOVS     r0,#0
000724  466b              MOV      r3,sp                 ;581
000726  4602              MOV      r2,r0
                  |L1.1832|
;;;588    		if(str[i] == '\r' || str[i] == '\n' || str[i] == '!')
000728  5c19              LDRB     r1,[r3,r0]
00072a  290d              CMP      r1,#0xd
00072c  d003              BEQ      |L1.1846|
00072e  290a              CMP      r1,#0xa
000730  d001              BEQ      |L1.1846|
000732  2921              CMP      r1,#0x21
000734  d100              BNE      |L1.1848|
                  |L1.1846|
;;;589    			str[i] = 0;
000736  541a              STRB     r2,[r3,r0]
                  |L1.1848|
000738  1c40              ADDS     r0,r0,#1              ;587
00073a  b2c0              UXTB     r0,r0                 ;587
00073c  281e              CMP      r0,#0x1e              ;587
00073e  d3f3              BCC      |L1.1832|
;;;590    
;;;591    	uart_putString(UART_LINK_LPC,str);
000740  4619              MOV      r1,r3
000742  2002              MOVS     r0,#2
000744  f7fffffe          BL       uart_putString
;;;592    	uart_putString(UART_LINK_LPC,"!\0");
000748  a182              ADR      r1,|L1.2388|
00074a  2002              MOVS     r0,#2
00074c  f7fffffe          BL       uart_putString
;;;593    
;;;594    	sprintf(buf_tx,"OK"); 
000750  a181              ADR      r1,|L1.2392|
000752  4882              LDR      r0,|L1.2396|
000754  f7fffffe          BL       __2sprintf
;;;595    }
000758  b008              ADD      sp,sp,#0x20
00075a  bd10              POP      {r4,pc}
;;;596    
                          ENDP

                  repeat_IR PROC
;;;646    *****************************************************************************/
;;;647    void repeat_IR(char *str_IdIr, char qtd_interval_100ms, char time_start_100ms)
00075c  e92d4ff7          PUSH     {r0-r2,r4-r11,lr}
;;;648    {
;;;649    	char i, cont=0, start=0;
;;;650    
;;;651    	memset(buf_rx,0,sizeof(buf_rx));
000760  487e              LDR      r0,|L1.2396|
000762  460d              MOV      r5,r1                 ;648
000764  2400              MOVS     r4,#0                 ;649
000766  4616              MOV      r6,r2                 ;648
000768  4627              MOV      r7,r4                 ;649
00076a  21a0              MOVS     r1,#0xa0
00076c  30a0              ADDS     r0,r0,#0xa0
00076e  f7fffffe          BL       __aeabi_memclr
;;;652    	NVIC_EnableIRQ(UART2_IRQn);		/*Habilita a interrupção serial para receber a tecla despressionada (TOU 000)*/
000772  2007              MOVS     r0,#7
000774  f7fffffe          BL       NVIC_EnableIRQ
;;;653    	while(1)
;;;654    	{
;;;655    		/*Sai do laço caso a tecla deixe de ser pressionada ou aconteça algum erro ao enviar o IR*/	
;;;656    		if(strstr(buf_rx,"TOU 000") || buf_tx[0] == 'E')
;;;657    			break;
;;;658    		else
;;;659    			cmd_ir_send(str_IdIr);  /*Envia o IR localizado no endereço recebido pela função*/	
;;;660    
;;;661    		wdt_feed();
000778  f04f0baa          MOV      r11,#0xaa
00077c  f04f4880          MOV      r8,#0x40000000
000780  f04f0a55          MOV      r10,#0x55
                  |L1.1924|
000784  4875              LDR      r0,|L1.2396|
000786  a19a              ADR      r1,|L1.2544|
000788  30a0              ADDS     r0,r0,#0xa0           ;656
00078a  f7fffffe          BL       strstr
00078e  bb68              CBNZ     r0,|L1.2028|
000790  4872              LDR      r0,|L1.2396|
000792  7800              LDRB     r0,[r0,#0]            ;656  ; buf_tx
000794  2845              CMP      r0,#0x45              ;656
000796  d029              BEQ      |L1.2028|
000798  9800              LDR      r0,[sp,#0]            ;659
00079a  f7fffffe          BL       cmd_ir_send
00079e  46d9              MOV      r9,r11
0007a0  f888b008          STRB     r11,[r8,#8]
0007a4  f888a008          STRB     r10,[r8,#8]
;;;662    		if(!start)	/*Apenas na inicialização*/
0007a8  b95f              CBNZ     r7,|L1.1986|
;;;663    		{
;;;664    			if(time_start_100ms)	/*Existe tempo de start para o IR*/
0007aa  b14e              CBZ      r6,|L1.1984|
;;;665    			{
;;;666    				while(1)	/*Loop para da um tempo minimo para o primeiro IR enviado*/
;;;667    				{
;;;668    					/*Contagem de tempo para comparação com o tempo de Start*/
;;;669    					timer_poll();
;;;670    					if(tick)
0007ac  4f92              LDR      r7,|L1.2552|
                  |L1.1966|
0007ae  f7fffffe          BL       timer_poll
0007b2  7838              LDRB     r0,[r7,#0]  ; tick
0007b4  2800              CMP      r0,#0
0007b6  d0fa              BEQ      |L1.1966|
;;;671    						if(++cont >= time_start_100ms)break;
0007b8  1c64              ADDS     r4,r4,#1
0007ba  b2e4              UXTB     r4,r4
0007bc  42b4              CMP      r4,r6
0007be  d3f6              BCC      |L1.1966|
                  |L1.1984|
;;;672    				}
;;;673    			}
;;;674    			start = 1;	
0007c0  2701              MOVS     r7,#1
                  |L1.1986|
;;;675    		}
;;;676    		/*Continua no laço caso não tenha intervalo de repetição*/
;;;677    		if(!qtd_interval_100ms)	
0007c2  2d00              CMP      r5,#0
0007c4  d0de              BEQ      |L1.1924|
0007c6  46cb              MOV      r11,r9                ;661
0007c8  f8df922c          LDR      r9,|L1.2552|
;;;678    			continue;
;;;679    		/*Contagem de tempo para comparação com o intervalo de repetição*/
;;;680    		cont=0;
0007cc  2400              MOVS     r4,#0
                  |L1.1998|
;;;681    		while(1)
;;;682    		{
;;;683    			wdt_feed();
0007ce  f888b008          STRB     r11,[r8,#8]
0007d2  f888a008          STRB     r10,[r8,#8]
;;;684    			timer_poll();
0007d6  f7fffffe          BL       timer_poll
;;;685    			if(tick)
0007da  f8990000          LDRB     r0,[r9,#0]  ; tick
0007de  2800              CMP      r0,#0
0007e0  d0f5              BEQ      |L1.1998|
;;;686    				if(++cont >= qtd_interval_100ms)	/*No primeiro IR demora um pouco mais*/
0007e2  1c64              ADDS     r4,r4,#1
0007e4  b2e4              UXTB     r4,r4
0007e6  42ac              CMP      r4,r5
0007e8  d3f1              BCC      |L1.1998|
0007ea  e7cb              B        |L1.1924|
                  |L1.2028|
;;;687    					break;
;;;688    		}	
;;;689    	}
;;;690    	NVIC_DisableIRQ(UART2_IRQn);		/*Desabilita novamente a interrupção serial*/
0007ec  2007              MOVS     r0,#7
0007ee  f7fffffe          BL       NVIC_DisableIRQ
;;;691    	memset(buf_rx,0,sizeof(buf_rx));	
0007f2  485a              LDR      r0,|L1.2396|
0007f4  21a0              MOVS     r1,#0xa0
0007f6  30a0              ADDS     r0,r0,#0xa0
0007f8  f7fffffe          BL       __aeabi_memclr
;;;692    	for(i=TOUCH_0;i<=TOUCH_15;i++)		/*Loop para desligar todos os leds 4x4*/
0007fc  2000              MOVS     r0,#0
;;;693    		out_leds &= ~(1<<i);
0007fe  497f              LDR      r1,|L1.2556|
000800  2401              MOVS     r4,#1                 ;674
                  |L1.2050|
000802  fa04f200          LSL      r2,r4,r0
000806  680b              LDR      r3,[r1,#0]  ; out_leds
000808  1c40              ADDS     r0,r0,#1              ;692
00080a  4393              BICS     r3,r3,r2
00080c  b2c0              UXTB     r0,r0                 ;692
00080e  600b              STR      r3,[r1,#0]            ;692  ; out_leds
000810  280f              CMP      r0,#0xf               ;692
000812  d9f6              BLS      |L1.2050|
;;;694    	touch_led_press = TOUCH_NONE;
000814  497a              LDR      r1,|L1.2560|
000816  20ff              MOVS     r0,#0xff
000818  7008              STRB     r0,[r1,#0]
;;;695    
;;;696    	if(buf_tx[0] == 'E')    /*Houve algum erro ao enviar o IR?*/
00081a  4850              LDR      r0,|L1.2396|
00081c  7800              LDRB     r0,[r0,#0]  ; buf_tx
00081e  2845              CMP      r0,#0x45
000820  d10c              BNE      |L1.2108|
;;;697    	{
;;;698    		beep(BEEP_ERROR);
000822  2003              MOVS     r0,#3
000824  f7fffffe          BL       beep
;;;699    		strcat(buf_tx,"\r\r\0");
000828  a176              ADR      r1,|L1.2564|
00082a  484c              LDR      r0,|L1.2396|
00082c  f7fffffe          BL       strcat
;;;700    		uart_putString(0,buf_tx);	/*String de erro*/
000830  b003              ADD      sp,sp,#0xc
000832  494a              LDR      r1,|L1.2396|
000834  e8bd4ff0          POP      {r4-r11,lr}
000838  2000              MOVS     r0,#0
00083a  e7fe              B        uart_putString
                  |L1.2108|
;;;701    	}
;;;702    }
00083c  e8bd8ffe          POP      {r1-r11,pc}
;;;703    
                          ENDP

                  cmd_rcv_touch PROC
;;;706    *****************************************************************************/
;;;707    void cmd_rcv_touch(char *par) 
000840  e92d43f0          PUSH     {r4-r9,lr}
;;;708    {
000844  b091              SUB      sp,sp,#0x44
000846  4605              MOV      r5,r0
;;;709    	char i,touch,str_IdIr[4],str_aux[50],flag_send_ir = __TRUE;	 
;;;710    
;;;711    	memset(str_IdIr,0,sizeof(str_IdIr));
000848  2000              MOVS     r0,#0
;;;712    	memset(str_aux,0,sizeof(str_aux));
00084a  900f              STR      r0,[sp,#0x3c]
00084c  2601              MOVS     r6,#1                 ;709
00084e  2134              MOVS     r1,#0x34
000850  a802              ADD      r0,sp,#8
000852  f7fffffe          BL       __aeabi_memclr4
;;;713    	str_IdIr[0] = par[1];
000856  7868              LDRB     r0,[r5,#1]
000858  f88d003c          STRB     r0,[sp,#0x3c]
;;;714    	str_IdIr[1] = par[2];
00085c  78a8              LDRB     r0,[r5,#2]
00085e  f88d003d          STRB     r0,[sp,#0x3d]
;;;715    	touch = atoi(str_IdIr);	
000862  a80f              ADD      r0,sp,#0x3c
000864  f7fffffe          BL       atoi
;;;716        
;;;717    	if(!(touchEnaDis & (1<<touch)))
000868  495c              LDR      r1,|L1.2524|
00086a  b2c4              UXTB     r4,r0                 ;715
00086c  46b0              MOV      r8,r6
00086e  fa08f004          LSL      r0,r8,r4
000872  6809              LDR      r1,[r1,#0]  ; touchEnaDis
000874  4681              MOV      r9,r0
000876  4208              TST      r0,r1
000878  d013              BEQ      |L1.2210|
;;;718    		return;
;;;719    
;;;720    	NVIC_DisableIRQ(UART2_IRQn);
00087a  2007              MOVS     r0,#7
00087c  f7fffffe          BL       NVIC_DisableIRQ
;;;721    	NVIC_DisableIRQ(UART0_IRQn);
000880  2005              MOVS     r0,#5
000882  f7fffffe          BL       NVIC_DisableIRQ
;;;722    	
;;;723    	if(touch > 23 && (par[0]-48))
;;;724    	{
;;;725    		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);
;;;726    		return;
;;;727    	}
;;;728    
;;;729    	if(par[0] - 48)	/*Transforma em inteiro*/
;;;730    	{
;;;731    		/*Desliga led anterior (IRs) caso ainda esteja ligado*/
;;;732    		for(i=TOUCH_0;i<=TOUCH_23;i++)
;;;733    		{
;;;734    			if(i == TOUCH_11 && !ir_state.bit.PwrPainel)
;;;735    				out_leds |= (1<<TOUCH_11);
;;;736    			else
;;;737    				out_leds &= ~(1 << i);
;;;738    		}
;;;739    			
;;;740    		touch_led_press = touch;
000886  f8dfc178          LDR      r12,|L1.2560|
00088a  4a5c              LDR      r2,|L1.2556|
00088c  7828              LDRB     r0,[r5,#0]            ;729
00088e  2c17              CMP      r4,#0x17              ;723
000890  d90a              BLS      |L1.2216|
000892  2830              CMP      r0,#0x30              ;723
                  |L1.2196|
000894  d04c              BEQ      |L1.2352|
000896  2207              MOVS     r2,#7                 ;725
000898  f2af31fc          ADR      r1,|L1.1184|
00089c  482f              LDR      r0,|L1.2396|
00089e  f7fffffe          BL       __2sprintf
                  |L1.2210|
;;;741    		out_leds |= (1 << touch_led_press);
;;;742    		atualiza_saidas();
;;;743    
;;;744    		if(rcv_cmd != RCV_CMD_TCP_CLIENT && rcv_cmd != RCV_CMD_TCP_SERVER)
;;;745    			beep(BEEP_PULSO);
;;;746    
;;;747    		/*(TV)->ID0:Source...ID1:CH-...ID2:CH+...ID3:ON...ID4:OFF...ID5:Vol-...ID6:Vol+*/
;;;748    		
;;;749    		/*(HOME)->ID7:Source...ID8:VOL-...ID9:VOL+...ID10:ON...ID11:OFF...ID12:PLAY...ID13:PAUSE...ID14:BACK...ID15:NEXT*/
;;;750    			/*ID16: Cursor Left...ID17: Cursor Righ...ID18: Cursor Down*/
;;;751    		
;;;752    		/*(AR)->ID19:16°...ID20:17°............ID33:30°...ID34:ON...ID35:OFF..ID36:SWING ON..ID37:SWING OFF*/
;;;753    
;;;754    		if(touch == TOUCH_0)	/*Touch referente ao Power da TV*/
;;;755    		{
;;;756    			if(!ir_state.bit.PwrTv)strcpy(str_IdIr,ADDR_TV_ON);		/*IR power tv on*/
;;;757    			else				   strcpy(str_IdIr,ADDR_TV_OFF);	/*IR power tv off*/
;;;758    
;;;759    			ir_state.bit.PwrTv = !ir_state.bit.PwrTv;
;;;760    			sprintf(str_aux,"[Touch (%u) POWER %s TV]\r",touch,(ir_state.bit.PwrTv) ? "ON":"OFF");	/*String para debug*/
;;;761    
;;;762    		}else
;;;763    		if(touch == TOUCH_1)	/*Touch referente ao Source da TV*/
;;;764    		{
;;;765    			strcpy(str_IdIr,ADDR_TV_SCR);		/*IR source tv*/
;;;766    			sprintf(str_aux,"[SOURCE TV]\r");	/*String para debug*/
;;;767    				
;;;768    		}else
;;;769    		if(touch == TOUCH_2)	/*Touch referente ao CH- da TV*/
;;;770    		{
;;;771    			strcpy(str_IdIr,ADDR_TV_CH_DOWN);	/*IR ch- tv*/
;;;772    			sprintf(str_aux,"[CH- TV]\r");		/*String para debug*/	
;;;773    			
;;;774    		}else
;;;775    		if(touch == TOUCH_3)	/*Touch referente ao CH+ da TV*/									
;;;776    		{
;;;777    			strcpy(str_IdIr,ADDR_TV_CH_UP);		/*IR ch+ tv*/
;;;778    			sprintf(str_aux,"[CH+ TV]\r");		/*String para debug*/	
;;;779    
;;;780    		}else 
;;;781    		if(touch == TOUCH_4)	/*Touch referente ao Power Home*/
;;;782    		{
;;;783    			if(!ir_state.bit.PwrHome)strcpy(str_IdIr,ADDR_HOME_ON); 	/*IR Power home on*/
;;;784    			else				     strcpy(str_IdIr,ADDR_HOME_OFF); 	/*IR Power home off*/
;;;785    
;;;786    			ir_state.bit.PwrHome = !ir_state.bit.PwrHome;
;;;787    			sprintf(str_aux,"[POWER %s HOME]\r",(ir_state.bit.PwrHome) ? "ON":"OFF");	/*String para debug*/
;;;788    
;;;789    		}else
;;;790    		if(touch == TOUCH_5)	/*Touch referente ao Source do Home*/
;;;791    		{
;;;792    			strcpy(str_IdIr,ADDR_HOME_SCR);		/*IR source home*/
;;;793    			sprintf(str_aux,"[SOURCE HOME]\r");	/*String para debug*/
;;;794    
;;;795    		}else
;;;796    		if(touch == TOUCH_6)	/*Touch referente ao Volume- da Tv*/
;;;797    		{
;;;798    			strcpy(str_IdIr,ADDR_TV_VOL_DOWN);	/*IR vol- tv*/
;;;799    			sprintf(str_aux,"[VOL- TV]\r");		/*String para debug*/
;;;800    			
;;;801    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;802    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;803    			{
;;;804    				repeat_IR(str_IdIr,0,5);		/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;805    				flag_send_ir = __FALSE;
;;;806    			}	
;;;807    
;;;808    		}else
;;;809    		if(touch == TOUCH_7)	/*Touch referente ao Volume+ da Tv*/
;;;810    		{
;;;811    			strcpy(str_IdIr,ADDR_TV_VOL_UP);	/*IR vol+ tv*/
;;;812    			sprintf(str_aux,"[VOL+ TV]\r");		/*String para debug*/
;;;813    			
;;;814    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;815    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;816    			{
;;;817    				repeat_IR(str_IdIr,0,5);		/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;818    				flag_send_ir = __FALSE;
;;;819    			}
;;;820    
;;;821    		}else
;;;822    		if(touch == TOUCH_8)	/*Touch referente ao cursor Left do Home*/	
;;;823    		{
;;;824    			strcpy(str_IdIr,ADDR_HOME_LEFT);	/*IR left home*/
;;;825    			sprintf(str_aux,"[LEFT HOME]\r");	/*String para debug*/
;;;826    			
;;;827    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;828    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;829    			{
;;;830    				repeat_IR(str_IdIr,0,5);		/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;831    				flag_send_ir = __FALSE;	
;;;832    			}
;;;833    			ir_state.bit.PlayPause = __FALSE;	/*Deixa a tecla Play/Pause preparada para enviar o play caso pressionada*/
;;;834    
;;;835    		}else
;;;836    		if(touch == TOUCH_9)	/*Touch referente ao cursor Righ do Home*/
;;;837    		{
;;;838    			strcpy(str_IdIr,ADDR_HOME_RIGH);	/*IR righ home*/
;;;839    			sprintf(str_aux,"[RIGH HOME]\r");	/*String para debug*/
;;;840    			
;;;841    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;842    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;843    			{
;;;844    				repeat_IR(str_IdIr,0,5);		/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;845    				flag_send_ir = __FALSE;	
;;;846    			}
;;;847    			ir_state.bit.PlayPause = __FALSE;	/*Deixa a tecla Play/Pause preparada para enviar o play caso pressionada*/	
;;;848    
;;;849    		}else
;;;850    		if(touch == TOUCH_10)	/*Touch referente ao Volume- do Home*/
;;;851    		{
;;;852    			strcpy(str_IdIr,ADDR_HOME_VOL_DOWN);	/*IR vol- home*/
;;;853    			sprintf(str_aux,"[VOL- HOME]\r");		/*String para debug*/
;;;854    			
;;;855    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;856    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;857    			{
;;;858    				repeat_IR(str_IdIr,0,5);			/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;859    				flag_send_ir = __FALSE;
;;;860    			}
;;;861    
;;;862    		}else
;;;863    		if(touch == TOUCH_11)	/*Touch referente ao Volume+ do Home*/
;;;864    		{
;;;865    			strcpy(str_IdIr,ADDR_HOME_VOL_UP);		/*IR vol+ home*/
;;;866    			sprintf(str_aux,"[VOL+ HOME]\r");		/*String para debug*/
;;;867    
;;;868    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;869    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;870    			{
;;;871    				repeat_IR(str_IdIr,0,5);			/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;872    				flag_send_ir = __FALSE;
;;;873    			}
;;;874    
;;;875    		}else
;;;876    		if(touch == TOUCH_12)	/*Touch referente ao cursor Down do home*/	
;;;877    		{
;;;878    			strcpy(str_IdIr,ADDR_HOME_DOWN);		/*IR down home*/
;;;879    			sprintf(str_aux,"[DOWN HOME]\r");		/*String para debug*/
;;;880    			
;;;881    			/*Envia repetidamente o IR apenas se pressionar no teclado. Pelo software executa o IR apenas uma vez*/
;;;882    			if(rcv_cmd == RCV_CMD_UART_2)		
;;;883    			{
;;;884    				repeat_IR(str_IdIr,0,5);			/*ID, Intervalo de repetição(n*100ms) e Intervalo start(ms)*/
;;;885    				flag_send_ir = __FALSE;	
;;;886    			}
;;;887    			ir_state.bit.PlayPause = __FALSE;	/*Deixa a tecla Play/Pause preparada para enviar o play caso pressionada*/
;;;888    
;;;889    		}else
;;;890    		if(touch == TOUCH_13)	/*Touch referente ao Play/Pause do Home*/	
;;;891    		{
;;;892    			if(!ir_state.bit.PlayPause)strcpy(str_IdIr,ADDR_HOME_PLAY); 	/*IR play*/
;;;893    			else				       strcpy(str_IdIr,ADDR_HOME_PAUSE); 	/*IR pause*/
;;;894    
;;;895    			ir_state.bit.PlayPause = !ir_state.bit.PlayPause;
;;;896    			sprintf(str_aux,"[%s HOME]\r",(ir_state.bit.PlayPause)? "PLAY":"PAUSE");	/*String para debug*/
;;;897    
;;;898    		}else
;;;899    		if(touch == TOUCH_14)	/*Touch referente ao Back do home*/	
;;;900    		{
;;;901    			strcpy(str_IdIr,ADDR_HOME_BACK);	/*IR back home*/
;;;902    			sprintf(str_aux,"[BACK HOME]\r");	/*String para debug*/
;;;903    
;;;904    		}else
;;;905    		if(touch == TOUCH_15)	/*Touch referente ao Next do Home*/	
;;;906    		{
;;;907    			strcpy(str_IdIr,ADDR_HOME_NEXT);	/*IR next home*/
;;;908    			sprintf(str_aux,"[NEXT HOME]\r");	/*String para debug*/
;;;909    
;;;910    		}else
;;;911    		if(touch == TOUCH_17)	/*Touch referente ao Power do AR*/	
;;;912    		{
;;;913    			if(!ir_state.bit.PwrAr)strcpy(str_IdIr,ADDR_AR_PWR_ON);  /*IR power ar on*/
;;;914    			else				   strcpy(str_IdIr,ADDR_AR_PWR_OFF); /*IR power ar off*/
;;;915    						
;;;916    			ir_state.bit.PwrAr = !ir_state.bit.PwrAr;
;;;917    			sprintf(str_aux,"[%s] [SWING %s] [IR ID:%s] [POWER %s AR]\r",(atoi(cfg.file.mode_func_ar))? "IN":"OUT", 
;;;918    				(ir_state.bit.ArSwing)? "ON":"OFF", str_IdIr, (ir_state.bit.PwrAr) ? "ON":"OFF");	/*String para debug*/
;;;919    		}else
;;;920    		if(touch == TOUCH_19 || touch == TOUCH_21 || touch == TOUCH_23)
;;;921    		{
;;;922    			if(touch == TOUCH_19)
;;;923    			{
;;;924    				if(temp_ar < TEMPERATURA_MAX) 
;;;925    					temp_ar++;
;;;926    				sprintf(str_IdIr,"%u\0",temp_ar + 3); 	/*IR temp*/
;;;927    
;;;928    			}else
;;;929    			if(touch == TOUCH_21)
;;;930    			{
;;;931    				if(temp_ar > TEMPERATURA_MIN) 
;;;932    					temp_ar--;
;;;933    				sprintf(str_IdIr,"%u\0",temp_ar + 3); 	/*IR temp*/
;;;934    
;;;935    			}else
;;;936    			if(touch == TOUCH_23)
;;;937    			{
;;;938    				ir_state.bit.ArSwing = !ir_state.bit.ArSwing;			/*IR swing ar*/
;;;939    				if(atoi(cfg.file.mode_func_ar)) 	/*Swing In (Função swing embutida na temperatura)?*/
;;;940    					sprintf(str_IdIr,"%u\0",temp_ar + 3);  
;;;941    				else
;;;942    				{
;;;943    					if(!ir_state.bit.ArSwing)strcpy(str_IdIr,ADDR_AR_SWING_ON); 	/*Endereço Swing On*/
;;;944    					else					 strcpy(str_IdIr,ADDR_AR_SWING_OFF); 	/*Endereço Swing Off*/		 
;;;945    				}
;;;946    			}
;;;947    
;;;948    			sprintf(str_aux,"[%s] [SWING %s] [IR ID:%s] [TEMP %u°]\r",(atoi(cfg.file.mode_func_ar))? "IN":"OUT", 
;;;949    			   (ir_state.bit.ArSwing)? "ON":"OFF", str_IdIr, temp_ar);	/*String para debug*/
;;;950    
;;;951    		}else
;;;952    		{
;;;953    			/*nenhuma função para o touch recebido*/
;;;954    			return;
;;;955    		}
;;;956    
;;;957    		if(flag_send_ir)		/*Precisa enviar IR?*/
;;;958    		{
;;;959    			cmd_ir_send(str_IdIr);	/*Chama função que envia o ir cujo id do ir é pasado como parâmetro*/
;;;960    			if(buf_tx[0] == 'E')    /*Houve algum erro ao enviar o IR?*/
;;;961    			{
;;;962    				beep(BEEP_ERROR);
;;;963    				strcat(buf_tx,"\r\r\0");
;;;964    				uart_putString(0,buf_tx);
;;;965    
;;;966    			}else
;;;967    			{							 	/*Sem erros*/
;;;968    				//strcat(str_aux,"\r\0");
;;;969    				//uart_putString(0,str_aux);
;;;970    				//printf("[Touch:%u] [IR ID:%s] %s\r",touch, str_IdIr, str_aux);
;;;971    				//fflush(stdout);
;;;972    				sprintf(buf_tx,"OK %u",touch);	
;;;973    			}
;;;974    			printf("[Touch:%u] [IR ID:%s] %s\r",touch, str_IdIr, str_aux);
;;;975    			fflush(stdout);
;;;976    		}else
;;;977    		{
;;;978    //			strcat(str_aux,"\r\0");
;;;979    //			uart_putString(0,str_aux);
;;;980    			printf("[Touch:%u] [IR ID:%s] %s\r",touch, str_IdIr, str_aux);
;;;981    			fflush(stdout);	
;;;982    		}		
;;;983    	}else
;;;984    	{ 
;;;985    		for(i=TOUCH_0;i<=TOUCH_23;i++)			/*Loop para desligar todos os leds 4x4*/
;;;986    			out_leds &= ~(1<<i);
;;;987    		touch_led_press = TOUCH_NONE;
;;;988    	}
;;;989    }
0008a2  b011              ADD      sp,sp,#0x44
0008a4  e8bd83f0          POP      {r4-r9,pc}
                  |L1.2216|
0008a8  2830              CMP      r0,#0x30              ;729
0008aa  d0f3              BEQ      |L1.2196|
0008ac  4d56              LDR      r5,|L1.2568|
0008ae  2000              MOVS     r0,#0                 ;732
0008b0  7829              LDRB     r1,[r5,#0]            ;734
0008b2  e003              B        |L1.2236|
                  |L1.2228|
0008b4  280b              CMP      r0,#0xb               ;734
0008b6  d101              BNE      |L1.2236|
0008b8  07cb              LSLS     r3,r1,#31             ;734
0008ba  d03a              BEQ      |L1.2354|
                  |L1.2236|
0008bc  6813              LDR      r3,[r2,#0]            ;737  ; out_leds
0008be  fa08f700          LSL      r7,r8,r0              ;737
0008c2  43bb              BICS     r3,r3,r7              ;737
                  |L1.2244|
0008c4  1c40              ADDS     r0,r0,#1              ;732
0008c6  b2c0              UXTB     r0,r0                 ;732
0008c8  6013              STR      r3,[r2,#0]            ;732  ; out_leds
0008ca  2817              CMP      r0,#0x17              ;732
0008cc  d9f2              BLS      |L1.2228|
0008ce  f88c4000          STRB     r4,[r12,#0]           ;740
0008d2  ea490003          ORR      r0,r9,r3              ;741
0008d6  6010              STR      r0,[r2,#0]            ;742  ; out_leds
0008d8  f7fffffe          BL       atualiza_saidas
0008dc  4f2e              LDR      r7,|L1.2456|
0008de  7838              LDRB     r0,[r7,#0]            ;744  ; rcv_cmd
0008e0  2803              CMP      r0,#3                 ;744
0008e2  d004              BEQ      |L1.2286|
0008e4  2804              CMP      r0,#4                 ;744
0008e6  d002              BEQ      |L1.2286|
0008e8  2000              MOVS     r0,#0                 ;745
0008ea  f7fffffe          BL       beep
                  |L1.2286|
0008ee  b1f4              CBZ      r4,|L1.2350|
0008f0  2c01              CMP      r4,#1                 ;763
0008f2  d01f              BEQ      |L1.2356|
0008f4  2c02              CMP      r4,#2                 ;769
0008f6  d01e              BEQ      |L1.2358|
0008f8  2c03              CMP      r4,#3                 ;775
0008fa  d01d              BEQ      |L1.2360|
0008fc  2c04              CMP      r4,#4                 ;781
0008fe  d01c              BEQ      |L1.2362|
000900  2c05              CMP      r4,#5                 ;790
000902  d01b              BEQ      |L1.2364|
000904  2c06              CMP      r4,#6                 ;796
000906  d01a              BEQ      |L1.2366|
000908  2c07              CMP      r4,#7                 ;809
00090a  d07f              BEQ      |L1.2572|
00090c  2c08              CMP      r4,#8                 ;822
00090e  d07e              BEQ      |L1.2574|
000910  2c09              CMP      r4,#9                 ;836
000912  d07d              BEQ      |L1.2576|
000914  2c0a              CMP      r4,#0xa               ;850
000916  d07c              BEQ      |L1.2578|
000918  2c0b              CMP      r4,#0xb               ;863
00091a  d07b              BEQ      |L1.2580|
00091c  2c0c              CMP      r4,#0xc               ;876
00091e  d07a              BEQ      |L1.2582|
000920  2c0d              CMP      r4,#0xd               ;890
000922  d079              BEQ      |L1.2584|
000924  2c0e              CMP      r4,#0xe               ;899
000926  d078              BEQ      |L1.2586|
000928  2c0f              CMP      r4,#0xf               ;905
00092a  d077              BEQ      |L1.2588|
00092c  e077              B        |L1.2590|
                  |L1.2350|
00092e  e09c              B        |L1.2666|
                  |L1.2352|
000930  e1d3              B        |L1.3290|
                  |L1.2354|
000932  e096              B        |L1.2658|
                  |L1.2356|
000934  e0b0              B        |L1.2712|
                  |L1.2358|
000936  e0b6              B        |L1.2726|
                  |L1.2360|
000938  e0bc              B        |L1.2740|
                  |L1.2362|
00093a  e0c1              B        |L1.2752|
                  |L1.2364|
00093c  e0d9              B        |L1.2802|
                  |L1.2366|
00093e  e0de              B        |L1.2814|
                  |L1.2368|
                          DCD      type_dim0
                  |L1.2372|
000944  54444920          DCB      "TDI 01",0
000948  303100  
00094b  00                DCB      0
                  |L1.2380|
00094c  54444920          DCB      "TDI 00",0
000950  303000  
000953  00                DCB      0
                  |L1.2388|
000954  2100              DCB      "!",0
000956  00                DCB      0
000957  00                DCB      0
                  |L1.2392|
000958  4f4b00            DCB      "OK",0
00095b  00                DCB      0
                  |L1.2396|
                          DCD      ||.bss||
                  |L1.2400|
                          DCD      type_dim1
                  |L1.2404|
000964  54444920          DCB      "TDI "
                  |L1.2408|
000968  313100            DCB      "11",0
00096b  00                DCB      0
                  |L1.2412|
00096c  54444920          DCB      "TDI "
                  |L1.2416|
000970  313000            DCB      "10",0
000973  00                DCB      0
                  |L1.2420|
                          DCD      type_dim2
                  |L1.2424|
000978  54444920          DCB      "TDI 21",0
00097c  323100  
00097f  00                DCB      0
                  |L1.2432|
000980  54444920          DCB      "TDI 20",0
000984  323000  
000987  00                DCB      0
                  |L1.2440|
000988  54444920          DCB      "TDI %u %u %u",0
00098c  25752025
000990  75202575
000994  00      
000995  00                DCB      0
000996  00                DCB      0
000997  00                DCB      0
                  |L1.2456|
                          DCD      ||.data||
                  |L1.2460|
00099c  44494d4d          DCB      "DIMMER",0
0009a0  455200  
0009a3  00                DCB      0
                  |L1.2468|
0009a4  4f4e4f46          DCB      "ONOFF",0
0009a8  4600    
0009aa  00                DCB      0
0009ab  00                DCB      0
                  |L1.2476|
0009ac  5b547970          DCB      "[Type Dimmer's config: 0:%s..1:%s..2:%s]\r",0
0009b0  65204469
0009b4  6d6d6572
0009b8  27732063
0009bc  6f6e6669
0009c0  673a2030
0009c4  3a25732e
0009c8  2e313a25
0009cc  732e2e32
0009d0  3a25735d
0009d4  0d00    
0009d6  00                DCB      0
0009d7  00                DCB      0
                  |L1.2520|
                          DCD      __stdout
                  |L1.2524|
                          DCD      touchEnaDis
                  |L1.2528|
0009e0  454e5420          DCB      "ENT "
                  |L1.2532|
0009e4  257500            DCB      "%u",0
0009e7  00                DCB      0
                  |L1.2536|
0009e8  53455420          DCB      "SET ",0
0009ec  00      
0009ed  00                DCB      0
0009ee  00                DCB      0
0009ef  00                DCB      0
                  |L1.2544|
0009f0  544f5520          DCB      "TOU 000",0
0009f4  30303000
                  |L1.2552|
                          DCD      tick
                  |L1.2556|
                          DCD      out_leds
                  |L1.2560|
                          DCD      touch_led_press
                  |L1.2564|
000a04  0d0d00            DCB      "\r\r",0
000a07  00                DCB      0
                  |L1.2568|
                          DCD      ir_state
                  |L1.2572|
000a0c  e086              B        |L1.2844|
                  |L1.2574|
000a0e  e08b              B        |L1.2856|
                  |L1.2576|
000a10  e098              B        |L1.2884|
                  |L1.2578|
000a12  e0a7              B        |L1.2916|
                  |L1.2580|
000a14  e0ac              B        |L1.2928|
                  |L1.2582|
000a16  e0b7              B        |L1.2952|
                  |L1.2584|
000a18  e0bc              B        |L1.2964|
                  |L1.2586|
000a1a  e0d5              B        |L1.3016|
                  |L1.2588|
000a1c  e0da              B        |L1.3028|
                  |L1.2590|
000a1e  f10d083c          ADD      r8,sp,#0x3c           ;709
000a22  48ff              LDR      r0,|L1.3616|
000a24  2c11              CMP      r4,#0x11              ;911
000a26  4681              MOV      r9,r0                 ;917
000a28  d06f              BEQ      |L1.2826|
000a2a  4ffe              LDR      r7,|L1.3620|
000a2c  2c13              CMP      r4,#0x13              ;920
000a2e  d06d              BEQ      |L1.2828|
000a30  2c15              CMP      r4,#0x15              ;920
000a32  d06c              BEQ      |L1.2830|
000a34  2c17              CMP      r4,#0x17              ;920
000a36  f47faf34          BNE      |L1.2210|
000a3a  7828              LDRB     r0,[r5,#0]            ;938  ; ir_state
000a3c  f3401140          SBFX     r1,r0,#5,#1           ;938
000a40  1c49              ADDS     r1,r1,#1              ;938
000a42  f3611045          BFI      r0,r1,#5,#1           ;938
000a46  7028              STRB     r0,[r5,#0]            ;938
000a48  4648              MOV      r0,r9                 ;938
000a4a  f7fffffe          BL       atoi
000a4e  2800              CMP      r0,#0                 ;939
000a50  d070              BEQ      |L1.2868|
000a52  783a              LDRB     r2,[r7,#0]            ;940  ; temp_ar
000a54  1cd2              ADDS     r2,r2,#3              ;940
000a56  f2af0174          ADR      r1,|L1.2532|
000a5a  a80f              ADD      r0,sp,#0x3c           ;940
                  |L1.2652|
000a5c  f7fffffe          BL       __2sprintf
000a60  e102              B        |L1.3176|
                  |L1.2658|
000a62  6813              LDR      r3,[r2,#0]            ;735  ; out_leds
000a64  f4436300          ORR      r3,r3,#0x800          ;735
000a68  e72c              B        |L1.2244|
                  |L1.2666|
000a6a  7828              LDRB     r0,[r5,#0]            ;756  ; ir_state
000a6c  0741              LSLS     r1,r0,#29             ;756
000a6e  d401              BMI      |L1.2676|
000a70  a1ed              ADR      r1,|L1.3624|
000a72  e000              B        |L1.2678|
                  |L1.2676|
000a74  a1ed              ADR      r1,|L1.3628|
                  |L1.2678|
000a76  a3ee              ADR      r3,|L1.3632|
000a78  8809              LDRH     r1,[r1,#0]            ;757
000a7a  f8ad103c          STRH     r1,[sp,#0x3c]         ;757
000a7e  f3400180          SBFX     r1,r0,#2,#1           ;759
000a82  f1010101          ADD      r1,r1,#1              ;759
000a86  f3610082          BFI      r0,r1,#2,#1           ;759
000a8a  7028              STRB     r0,[r5,#0]            ;759
000a8c  0740              LSLS     r0,r0,#29             ;760
000a8e  d400              BMI      |L1.2706|
000a90  a3e8              ADR      r3,|L1.3636|
                  |L1.2706|
000a92  4622              MOV      r2,r4                 ;760
000a94  a1e8              ADR      r1,|L1.3640|
000a96  e0f9              B        |L1.3212|
                  |L1.2712|
000a98  f2af50d4          ADR      r0,|L1.1224|
000a9c  8800              LDRH     r0,[r0,#0]            ;765
000a9e  f8ad003c          STRH     r0,[sp,#0x3c]         ;765
000aa2  a1ec              ADR      r1,|L1.3668|
000aa4  e09b              B        |L1.3038|
                  |L1.2726|
000aa6  f2af50dc          ADR      r0,|L1.1228|
000aaa  8800              LDRH     r0,[r0,#0]            ;771
000aac  f8ad003c          STRH     r0,[sp,#0x3c]         ;771
000ab0  a1ec              ADR      r1,|L1.3684|
000ab2  e094              B        |L1.3038|
                  |L1.2740|
000ab4  a0ee              ADR      r0,|L1.3696|
000ab6  a1ef              ADR      r1,|L1.3700|
000ab8  8800              LDRH     r0,[r0,#0]            ;777
000aba  f8ad003c          STRH     r0,[sp,#0x3c]         ;777
000abe  e08e              B        |L1.3038|
                  |L1.2752|
000ac0  7828              LDRB     r0,[r5,#0]            ;783  ; ir_state
000ac2  0700              LSLS     r0,r0,#28             ;783
000ac4  d402              BMI      |L1.2764|
000ac6  f2af1158          ADR      r1,|L1.2416|
000aca  e001              B        |L1.2768|
                  |L1.2764|
000acc  f2af1168          ADR      r1,|L1.2408|
                  |L1.2768|
000ad0  a80f              ADD      r0,sp,#0x3c           ;784
000ad2  f7fffffe          BL       strcpy
000ad6  7828              LDRB     r0,[r5,#0]            ;786  ; ir_state
000ad8  a2d5              ADR      r2,|L1.3632|
000ada  f34001c0          SBFX     r1,r0,#3,#1           ;786
000ade  f1010101          ADD      r1,r1,#1              ;786
000ae2  f36100c3          BFI      r0,r1,#3,#1           ;786
000ae6  7028              STRB     r0,[r5,#0]            ;786
000ae8  0700              LSLS     r0,r0,#28             ;787
000aea  d400              BMI      |L1.2798|
000aec  a2d1              ADR      r2,|L1.3636|
                  |L1.2798|
000aee  a1e4              ADR      r1,|L1.3712|
000af0  e066              B        |L1.3008|
                  |L1.2802|
000af2  a0e8              ADR      r0,|L1.3732|
000af4  a1e8              ADR      r1,|L1.3736|
000af6  8800              LDRH     r0,[r0,#0]            ;792
000af8  f8ad003c          STRH     r0,[sp,#0x3c]         ;792
000afc  e06f              B        |L1.3038|
                  |L1.2814|
000afe  a0ea              ADR      r0,|L1.3752|
000b00  a1ea              ADR      r1,|L1.3756|
000b02  8800              LDRH     r0,[r0,#0]            ;798
000b04  f8ad003c          STRH     r0,[sp,#0x3c]         ;798
000b08  e037              B        |L1.2938|
                  |L1.2826|
000b0a  e06c              B        |L1.3046|
                  |L1.2828|
000b0c  e091              B        |L1.3122|
                  |L1.2830|
000b0e  e09b              B        |L1.3144|
                  |L1.2832|
000b10  2205              MOVS     r2,#5                 ;804
000b12  2100              MOVS     r1,#0                 ;804
000b14  a80f              ADD      r0,sp,#0x3c           ;804
000b16  f7fffffe          BL       repeat_IR
000b1a  e0c7              B        |L1.3244|
                  |L1.2844|
000b1c  a0e6              ADR      r0,|L1.3768|
000b1e  a1e7              ADR      r1,|L1.3772|
000b20  8800              LDRH     r0,[r0,#0]            ;811
000b22  f8ad003c          STRH     r0,[sp,#0x3c]         ;811
000b26  e028              B        |L1.2938|
                  |L1.2856|
000b28  a1e7              ADR      r1,|L1.3784|
000b2a  a80f              ADD      r0,sp,#0x3c           ;824
000b2c  f7fffffe          BL       strcpy
000b30  a1e6              ADR      r1,|L1.3788|
000b32  e00c              B        |L1.2894|
                  |L1.2868|
000b34  e08f              B        |L1.3158|
                  |L1.2870|
000b36  2205              MOVS     r2,#5                 ;830
000b38  2100              MOVS     r1,#0                 ;830
000b3a  a80f              ADD      r0,sp,#0x3c           ;830
000b3c  f7fffffe          BL       repeat_IR
000b40  2600              MOVS     r6,#0                 ;831
000b42  e00a              B        |L1.2906|
                  |L1.2884|
000b44  a1e5              ADR      r1,|L1.3804|
000b46  a80f              ADD      r0,sp,#0x3c           ;838
000b48  f7fffffe          BL       strcpy
000b4c  a1e4              ADR      r1,|L1.3808|
                  |L1.2894|
000b4e  a802              ADD      r0,sp,#8              ;825
000b50  f7fffffe          BL       __2sprintf
000b54  7838              LDRB     r0,[r7,#0]            ;828  ; rcv_cmd
000b56  2802              CMP      r0,#2                 ;828
000b58  d0ed              BEQ      |L1.2870|
                  |L1.2906|
000b5a  7828              LDRB     r0,[r5,#0]            ;887  ; ir_state
000b5c  f0200010          BIC      r0,r0,#0x10           ;887
000b60  7028              STRB     r0,[r5,#0]            ;887
000b62  e096              B        |L1.3218|
                  |L1.2916|
000b64  a0e2              ADR      r0,|L1.3824|
000b66  a1e3              ADR      r1,|L1.3828|
000b68  8800              LDRH     r0,[r0,#0]            ;852
000b6a  f8ad003c          STRH     r0,[sp,#0x3c]         ;852
000b6e  e004              B        |L1.2938|
                  |L1.2928|
000b70  a0e4              ADR      r0,|L1.3844|
000b72  a1e5              ADR      r1,|L1.3848|
000b74  8800              LDRH     r0,[r0,#0]            ;865
000b76  f8ad003c          STRH     r0,[sp,#0x3c]         ;865
                  |L1.2938|
000b7a  a802              ADD      r0,sp,#8              ;866
000b7c  f7fffffe          BL       __2sprintf
000b80  7838              LDRB     r0,[r7,#0]            ;869  ; rcv_cmd
000b82  2802              CMP      r0,#2                 ;869
000b84  d0c4              BEQ      |L1.2832|
000b86  e084              B        |L1.3218|
                  |L1.2952|
000b88  a1e3              ADR      r1,|L1.3864|
000b8a  a80f              ADD      r0,sp,#0x3c           ;878
000b8c  f7fffffe          BL       strcpy
000b90  a1e2              ADR      r1,|L1.3868|
000b92  e7dc              B        |L1.2894|
                  |L1.2964|
000b94  7828              LDRB     r0,[r5,#0]            ;892  ; ir_state
000b96  06c0              LSLS     r0,r0,#27             ;892
000b98  d401              BMI      |L1.2974|
000b9a  a1e4              ADR      r1,|L1.3884|
000b9c  e000              B        |L1.2976|
                  |L1.2974|
000b9e  a1e4              ADR      r1,|L1.3888|
                  |L1.2976|
000ba0  a80f              ADD      r0,sp,#0x3c           ;893
000ba2  f7fffffe          BL       strcpy
000ba6  7828              LDRB     r0,[r5,#0]            ;895  ; ir_state
000ba8  a2e2              ADR      r2,|L1.3892|
000baa  f3401100          SBFX     r1,r0,#4,#1           ;895
000bae  f1010101          ADD      r1,r1,#1              ;895
000bb2  f3611004          BFI      r0,r1,#4,#1           ;895
000bb6  7028              STRB     r0,[r5,#0]            ;895
000bb8  06c0              LSLS     r0,r0,#27             ;896
000bba  d400              BMI      |L1.3006|
000bbc  a2df              ADR      r2,|L1.3900|
                  |L1.3006|
000bbe  a1e1              ADR      r1,|L1.3908|
                  |L1.3008|
000bc0  a802              ADD      r0,sp,#8              ;896
000bc2  f7fffffe          BL       __2sprintf
000bc6  e064              B        |L1.3218|
                  |L1.3016|
000bc8  a1e1              ADR      r1,|L1.3920|
000bca  a80f              ADD      r0,sp,#0x3c           ;901
000bcc  f7fffffe          BL       strcpy
000bd0  a1e0              ADR      r1,|L1.3924|
000bd2  e004              B        |L1.3038|
                  |L1.3028|
000bd4  a1e3              ADR      r1,|L1.3940|
000bd6  a80f              ADD      r0,sp,#0x3c           ;907
000bd8  f7fffffe          BL       strcpy
000bdc  a1e2              ADR      r1,|L1.3944|
                  |L1.3038|
000bde  a802              ADD      r0,sp,#8              ;908
000be0  f7fffffe          BL       __2sprintf
000be4  e055              B        |L1.3218|
                  |L1.3046|
000be6  7828              LDRB     r0,[r5,#0]            ;913  ; ir_state
000be8  0780              LSLS     r0,r0,#30             ;913
000bea  d401              BMI      |L1.3056|
000bec  a1e2              ADR      r1,|L1.3960|
000bee  e000              B        |L1.3058|
                  |L1.3056|
000bf0  a1e2              ADR      r1,|L1.3964|
                  |L1.3058|
000bf2  4640              MOV      r0,r8                 ;914
000bf4  f7fffffe          BL       strcpy
000bf8  7828              LDRB     r0,[r5,#0]            ;916  ; ir_state
000bfa  f3400140          SBFX     r1,r0,#1,#1           ;916
000bfe  1c49              ADDS     r1,r1,#1              ;916
000c00  f3610041          BFI      r0,r1,#1,#1           ;916
000c04  7028              STRB     r0,[r5,#0]            ;916
000c06  4648              MOV      r0,r9                 ;916
000c08  f7fffffe          BL       atoi
000c0c  b110              CBZ      r0,|L1.3092|
000c0e  f2af7230          ADR      r2,|L1.1248|
000c12  e001              B        |L1.3096|
                  |L1.3092|
000c14  f2af723c          ADR      r2,|L1.1244|
                  |L1.3096|
000c18  7828              LDRB     r0,[r5,#0]            ;918  ; ir_state
000c1a  a185              ADR      r1,|L1.3632|
000c1c  0783              LSLS     r3,r0,#30             ;918
000c1e  d400              BMI      |L1.3106|
000c20  a184              ADR      r1,|L1.3636|
                  |L1.3106|
000c22  e9cd8100          STRD     r8,r1,[sp,#0]         ;918
000c26  a382              ADR      r3,|L1.3632|
000c28  0680              LSLS     r0,r0,#26             ;918
000c2a  d400              BMI      |L1.3118|
000c2c  a381              ADR      r3,|L1.3636|
                  |L1.3118|
000c2e  a1d4              ADR      r1,|L1.3968|
000c30  e02c              B        |L1.3212|
                  |L1.3122|
000c32  7838              LDRB     r0,[r7,#0]            ;924  ; temp_ar
000c34  281e              CMP      r0,#0x1e              ;924
000c36  d201              BCS      |L1.3132|
000c38  1c40              ADDS     r0,r0,#1              ;925
000c3a  e00a              B        |L1.3154|
                  |L1.3132|
000c3c  b2c2              UXTB     r2,r0                 ;926
000c3e  1cd2              ADDS     r2,r2,#3              ;926
000c40  f2af2160          ADR      r1,|L1.2532|
000c44  4640              MOV      r0,r8                 ;926
000c46  e709              B        |L1.2652|
                  |L1.3144|
000c48  7838              LDRB     r0,[r7,#0]            ;931  ; temp_ar
000c4a  2810              CMP      r0,#0x10              ;931
000c4c  d9f6              BLS      |L1.3132|
000c4e  f1a00001          SUB      r0,r0,#1              ;932
                  |L1.3154|
000c52  7038              STRB     r0,[r7,#0]            ;932
000c54  e7f2              B        |L1.3132|
                  |L1.3158|
000c56  7828              LDRB     r0,[r5,#0]            ;943  ; ir_state
000c58  0680              LSLS     r0,r0,#26             ;943
000c5a  d401              BMI      |L1.3168|
000c5c  a1d3              ADR      r1,|L1.4012|
000c5e  e000              B        |L1.3170|
                  |L1.3168|
000c60  a1d3              ADR      r1,|L1.4016|
                  |L1.3170|
000c62  a80f              ADD      r0,sp,#0x3c           ;943
000c64  f7fffffe          BL       strcpy
                  |L1.3176|
000c68  4648              MOV      r0,r9                 ;943
000c6a  f7fffffe          BL       atoi
000c6e  b110              CBZ      r0,|L1.3190|
000c70  f2af7294          ADR      r2,|L1.1248|
000c74  e001              B        |L1.3194|
                  |L1.3190|
000c76  f2af729c          ADR      r2,|L1.1244|
                  |L1.3194|
000c7a  7839              LDRB     r1,[r7,#0]            ;948  ; temp_ar
000c7c  a36c              ADR      r3,|L1.3632|
000c7e  e9cd8100          STRD     r8,r1,[sp,#0]         ;949
000c82  7828              LDRB     r0,[r5,#0]            ;949  ; ir_state
000c84  0680              LSLS     r0,r0,#26             ;949
000c86  d400              BMI      |L1.3210|
000c88  a36a              ADR      r3,|L1.3636|
                  |L1.3210|
000c8a  a1ca              ADR      r1,|L1.4020|
                  |L1.3212|
000c8c  a802              ADD      r0,sp,#8              ;949
000c8e  f7fffffe          BL       __2sprintf
                  |L1.3218|
000c92  b15e              CBZ      r6,|L1.3244|
000c94  a80f              ADD      r0,sp,#0x3c           ;959
000c96  f7fffffe          BL       cmd_ir_send
000c9a  48d0              LDR      r0,|L1.4060|
000c9c  7800              LDRB     r0,[r0,#0]            ;960  ; buf_tx
000c9e  2845              CMP      r0,#0x45              ;960
000ca0  d00e              BEQ      |L1.3264|
000ca2  4622              MOV      r2,r4                 ;972
000ca4  a1ce              ADR      r1,|L1.4064|
000ca6  48cd              LDR      r0,|L1.4060|
000ca8  f7fffffe          BL       __2sprintf
                  |L1.3244|
000cac  ab02              ADD      r3,sp,#8              ;980
000cae  aa0f              ADD      r2,sp,#0x3c           ;980
000cb0  4621              MOV      r1,r4                 ;980
000cb2  a0cd              ADR      r0,|L1.4072|
000cb4  f7fffffe          BL       __2printf
000cb8  48d2              LDR      r0,|L1.4100|
000cba  f7fffffe          BL       fflush
000cbe  e5f0              B        |L1.2210|
                  |L1.3264|
000cc0  2003              MOVS     r0,#3                 ;962
000cc2  f7fffffe          BL       beep
000cc6  f2af21c4          ADR      r1,|L1.2564|
000cca  48c4              LDR      r0,|L1.4060|
000ccc  f7fffffe          BL       strcat
000cd0  49c2              LDR      r1,|L1.4060|
000cd2  2000              MOVS     r0,#0                 ;964
000cd4  f7fffffe          BL       uart_putString
000cd8  e7e8              B        |L1.3244|
                  |L1.3290|
000cda  2000              MOVS     r0,#0                 ;985
                  |L1.3292|
000cdc  fa08f100          LSL      r1,r8,r0              ;986
000ce0  6813              LDR      r3,[r2,#0]            ;986  ; out_leds
000ce2  1c40              ADDS     r0,r0,#1              ;985
000ce4  438b              BICS     r3,r3,r1              ;986
000ce6  b2c0              UXTB     r0,r0                 ;985
000ce8  6013              STR      r3,[r2,#0]            ;985  ; out_leds
000cea  2817              CMP      r0,#0x17              ;985
000cec  d9f6              BLS      |L1.3292|
000cee  20ff              MOVS     r0,#0xff              ;987
000cf0  f88c0000          STRB     r0,[r12,#0]           ;987
000cf4  e5d5              B        |L1.2210|
;;;990    
                          ENDP

                  cmd_scene PROC
;;;993    *****************************************************************************/
;;;994    void cmd_scene(char *par) 
000cf6  b5f0              PUSH     {r4-r7,lr}
;;;995    {
000cf8  4604              MOV      r4,r0
;;;996    	char i,addr,erro = __FALSE, str[30];
;;;997    	
;;;998    	if(par[0] == '?')	/*Solicitando a alguma cena?*/	
000cfa  7800              LDRB     r0,[r0,#0]
000cfc  2500              MOVS     r5,#0                 ;996
;;;999    	{
;;;1000   		if(par[1] >= '0' && par[1] <= '3')	/*Cenas de 0 a 3?*/
;;;1001   		{
;;;1002   			if(read_scene(par[1]-48,FILE_DIMMER_SCENE))
;;;1003   				sprintf(buf_tx,"%s%u",aux_scene,par[1]-48);
;;;1004   			else
;;;1005   				sprintf(buf_tx,"ERROR %u",ERROR_SD); 
;;;1006   		}else
;;;1007   		{
;;;1008   			sprintf(buf_tx,"%s%u", (current_scene[0]==0) ? "SET 0000000000007" : current_scene, current_id_scene);
000cfe  4ec2              LDR      r6,|L1.4104|
;;;1009   			if(strcmp(current_scene,scene[current_id_scene])/*strlen(current_scene) < 15*/)
000d00  4fc2              LDR      r7,|L1.4108|
000d02  b089              SUB      sp,sp,#0x24           ;995
000d04  283f              CMP      r0,#0x3f              ;998
000d06  d025              BEQ      |L1.3412|
;;;1010   				sprintf(current_scene,"%s%u",scene[current_id_scene], current_id_scene);
;;;1011   		}	
;;;1012   		return;
;;;1013   	}
;;;1014   
;;;1015   	memset(str,0,sizeof(str));
000d08  2120              MOVS     r1,#0x20
000d0a  4668              MOV      r0,sp
000d0c  f7fffffe          BL       __aeabi_memclr4
;;;1016   
;;;1017   	strncpy(str,par,17);	/*Cena ex: 0SET 020020020000*/
000d10  2211              MOVS     r2,#0x11
000d12  4621              MOV      r1,r4
000d14  4668              MOV      r0,sp
000d16  f7fffffe          BL       strncpy
;;;1018   
;;;1019   	addr = str[0]-48;
000d1a  f89d0000          LDRB     r0,[sp,#0]
000d1e  466b              MOV      r3,sp                 ;996
000d20  3830              SUBS     r0,r0,#0x30
000d22  b2c4              UXTB     r4,r0
;;;1020   	for(i=0;i<20;i++)		/*Loop para eliminar o id da cena da string...Ex: SET 020020020000*/
000d24  2000              MOVS     r0,#0
                  |L1.3366|
;;;1021   		str[i] = str[i+1];
000d26  1819              ADDS     r1,r3,r0
000d28  7849              LDRB     r1,[r1,#1]
000d2a  5419              STRB     r1,[r3,r0]
000d2c  1c40              ADDS     r0,r0,#1              ;1020
000d2e  b2c0              UXTB     r0,r0                 ;1020
000d30  2814              CMP      r0,#0x14              ;1020
000d32  d3f8              BCC      |L1.3366|
;;;1022   
;;;1023   	for(i=4;i<16;i++)		/*Loop para verificar possiveis erros de parâmetro*/
000d34  2004              MOVS     r0,#4
000d36  f04f0c00          MOV      r12,#0                ;996
                  |L1.3386|
;;;1024   	{
;;;1025   		if(str[i] < '0' || str[i] > '9' || addr > 7)	
000d3a  5c19              LDRB     r1,[r3,r0]
000d3c  f1a10230          SUB      r2,r1,#0x30
000d40  2a0a              CMP      r2,#0xa
000d42  d201              BCS      |L1.3400|
000d44  2c07              CMP      r4,#7
000d46  d900              BLS      |L1.3402|
                  |L1.3400|
;;;1026   			erro = __TRUE;	
000d48  2501              MOVS     r5,#1
                  |L1.3402|
;;;1027   
;;;1028   		if(str[i] == '\r' || str[i] == '\n')	/*Elimina caracteres indesejados da cena*/
000d4a  290d              CMP      r1,#0xd
000d4c  d032              BEQ      |L1.3508|
000d4e  290a              CMP      r1,#0xa
000d50  d030              BEQ      |L1.3508|
000d52  e031              B        |L1.3512|
                  |L1.3412|
000d54  7860              LDRB     r0,[r4,#1]            ;1000
000d56  3830              SUBS     r0,r0,#0x30           ;1000
000d58  2803              CMP      r0,#3                 ;1000
000d5a  d80c              BHI      |L1.3446|
000d5c  b2c0              UXTB     r0,r0                 ;1002
000d5e  a1ac              ADR      r1,|L1.4112|
000d60  f7fffffe          BL       read_scene
000d64  b128              CBZ      r0,|L1.3442|
000d66  7863              LDRB     r3,[r4,#1]            ;1003
000d68  4aad              LDR      r2,|L1.4128|
000d6a  3b30              SUBS     r3,r3,#0x30           ;1003
000d6c  a1ad              ADR      r1,|L1.4132|
000d6e  489b              LDR      r0,|L1.4060|
000d70  e01c              B        |L1.3500|
                  |L1.3442|
000d72  220e              MOVS     r2,#0xe               ;1005
000d74  e030              B        |L1.3544|
                  |L1.3446|
000d76  48b2              LDR      r0,|L1.4160|
000d78  a2ac              ADR      r2,|L1.4140|
000d7a  7800              LDRB     r0,[r0,#0]            ;1008  ; current_scene
000d7c  b100              CBZ      r0,|L1.3456|
000d7e  4ab0              LDR      r2,|L1.4160|
                  |L1.3456|
000d80  7833              LDRB     r3,[r6,#0]            ;1008  ; current_id_scene
000d82  a1a8              ADR      r1,|L1.4132|
000d84  4895              LDR      r0,|L1.4060|
000d86  f7fffffe          BL       __2sprintf
000d8a  7830              LDRB     r0,[r6,#0]            ;1009  ; current_id_scene
000d8c  ebc01000          RSB      r0,r0,r0,LSL #4       ;1009
000d90  eb070140          ADD      r1,r7,r0,LSL #1       ;1009
000d94  48aa              LDR      r0,|L1.4160|
000d96  f7fffffe          BL       strcmp
000d9a  2800              CMP      r0,#0                 ;1009
000d9c  d008              BEQ      |L1.3504|
000d9e  7833              LDRB     r3,[r6,#0]            ;1010  ; current_id_scene
000da0  a1a0              ADR      r1,|L1.4132|
000da2  ebc31003          RSB      r0,r3,r3,LSL #4       ;1010
000da6  eb070240          ADD      r2,r7,r0,LSL #1       ;1010
000daa  48a5              LDR      r0,|L1.4160|
                  |L1.3500|
000dac  f7fffffe          BL       __2sprintf
                  |L1.3504|
;;;1029   			str[i] = 0;
;;;1030   	}
;;;1031   
;;;1032   	//printf("str:%s\r",str);
;;;1033   	//fflush(stdout);
;;;1034   
;;;1035   	if(strlen(str) != 16 || !strstr(str,"SET") || erro)	/*Há erro?*/
;;;1036   		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);
;;;1037   	else
;;;1038   	{
;;;1039   		if(save_scene(str,addr))		/*A cena foi salva no cartão sd?*/
;;;1040   		{
;;;1041   			init_scene(addr);			/*Lê a cena para se certificar que foi escrita no sd*/
;;;1042   
;;;1043   			sprintf(buf_tx,"%s%u",scene[addr],addr);
;;;1044   			if(rcv_cmd == RCV_CMD_UART_0)
;;;1045   			{	
;;;1046   				/*Envia imediatamente para o LPC1113 a alteração da cena 'addr' */
;;;1047   				uart_putString(UART_LINK_LPC,scene[addr]);
;;;1048   				uart_putString(UART_LINK_LPC,"!\0");
;;;1049   				strcpy(current_scene,scene[addr]);		/*Copia para a cena atual*/	
;;;1050   				current_id_scene = addr;
;;;1051   			}else
;;;1052   			{
;;;1053   				printf("Cena %u configurada: %s\r",addr,str);
;;;1054   				fflush(stdout);
;;;1055   			}
;;;1056   		}else
;;;1057   			sprintf(buf_tx,"ERROR %u",ERROR_SD);	/*Error permitido para cartão SD*/		
;;;1058   	}
;;;1059   }
000db0  b009              ADD      sp,sp,#0x24
000db2  bdf0              POP      {r4-r7,pc}
                  |L1.3508|
000db4  f803c000          STRB     r12,[r3,r0]           ;1029
                  |L1.3512|
000db8  1c40              ADDS     r0,r0,#1              ;1023
000dba  b2c0              UXTB     r0,r0                 ;1023
000dbc  2810              CMP      r0,#0x10              ;1023
000dbe  d3bc              BCC      |L1.3386|
000dc0  4618              MOV      r0,r3                 ;1035
000dc2  f7fffffe          BL       strlen
000dc6  2810              CMP      r0,#0x10              ;1035
000dc8  d105              BNE      |L1.3542|
000dca  a19e              ADR      r1,|L1.4164|
000dcc  4668              MOV      r0,sp                 ;1035
000dce  f7fffffe          BL       strstr
000dd2  b100              CBZ      r0,|L1.3542|
000dd4  b135              CBZ      r5,|L1.3556|
                  |L1.3542|
000dd6  2207              MOVS     r2,#7                 ;1036
                  |L1.3544|
000dd8  f6af113c          ADR      r1,|L1.1184|
000ddc  487f              LDR      r0,|L1.4060|
000dde  f7fffffe          BL       __2sprintf
000de2  e7e5              B        |L1.3504|
                  |L1.3556|
000de4  4621              MOV      r1,r4                 ;1039
000de6  4668              MOV      r0,sp                 ;1039
000de8  f7fffffe          BL       save_scene
000dec  2800              CMP      r0,#0                 ;1039
000dee  d0c0              BEQ      |L1.3442|
000df0  4620              MOV      r0,r4                 ;1041
000df2  f7fffffe          BL       init_scene
000df6  ebc41004          RSB      r0,r4,r4,LSL #4       ;1043
000dfa  eb070540          ADD      r5,r7,r0,LSL #1       ;1043
000dfe  462a              MOV      r2,r5                 ;1043
000e00  4623              MOV      r3,r4                 ;1043
000e02  a188              ADR      r1,|L1.4132|
000e04  4875              LDR      r0,|L1.4060|
000e06  f7fffffe          BL       __2sprintf
000e0a  488f              LDR      r0,|L1.4168|
000e0c  7800              LDRB     r0,[r0,#0]            ;1044  ; rcv_cmd
000e0e  2801              CMP      r0,#1                 ;1044
000e10  d005              BEQ      |L1.3614|
000e12  466a              MOV      r2,sp                 ;1053
000e14  4621              MOV      r1,r4                 ;1053
000e16  a08d              ADR      r0,|L1.4172|
000e18  f7fffffe          BL       __2printf
000e1c  e124              B        |L1.4200|
                  |L1.3614|
000e1e  e127              B        |L1.4208|
                  |L1.3616|
                          DCD      ||cfg||+0x88
                  |L1.3620|
                          DCD      temp_ar
                  |L1.3624|
000e28  3300              DCB      "3",0
000e2a  00                DCB      0
000e2b  00                DCB      0
                  |L1.3628|
000e2c  3400              DCB      "4",0
000e2e  00                DCB      0
000e2f  00                DCB      0
                  |L1.3632|
000e30  4f4e00            DCB      "ON",0
000e33  00                DCB      0
                  |L1.3636|
000e34  4f464600          DCB      "OFF",0
                  |L1.3640|
000e38  5b546f75          DCB      "[Touch (%u) POWER %s TV]\r",0
000e3c  63682028
000e40  25752920
000e44  504f5745
000e48  52202573
000e4c  2054565d
000e50  0d00    
000e52  00                DCB      0
000e53  00                DCB      0
                  |L1.3668|
000e54  5b534f55          DCB      "[SOURCE TV]\r",0
000e58  52434520
000e5c  54565d0d
000e60  00      
000e61  00                DCB      0
000e62  00                DCB      0
000e63  00                DCB      0
                  |L1.3684|
000e64  5b43482d          DCB      "[CH- TV]\r",0
000e68  2054565d
000e6c  0d00    
000e6e  00                DCB      0
000e6f  00                DCB      0
                  |L1.3696|
000e70  3200              DCB      "2",0
000e72  00                DCB      0
000e73  00                DCB      0
                  |L1.3700|
000e74  5b43482b          DCB      "[CH+ TV]\r",0
000e78  2054565d
000e7c  0d00    
000e7e  00                DCB      0
000e7f  00                DCB      0
                  |L1.3712|
000e80  5b504f57          DCB      "[POWER %s HOME]\r",0
000e84  45522025
000e88  7320484f
000e8c  4d455d0d
000e90  00      
000e91  00                DCB      0
000e92  00                DCB      0
000e93  00                DCB      0
                  |L1.3732|
000e94  3700              DCB      "7",0
000e96  00                DCB      0
000e97  00                DCB      0
                  |L1.3736|
000e98  5b534f55          DCB      "[SOURCE HOME]\r",0
000e9c  52434520
000ea0  484f4d45
000ea4  5d0d00  
000ea7  00                DCB      0
                  |L1.3752|
000ea8  3500              DCB      "5",0
000eaa  00                DCB      0
000eab  00                DCB      0
                  |L1.3756|
000eac  5b564f4c          DCB      "[VOL- TV]\r",0
000eb0  2d205456
000eb4  5d0d00  
000eb7  00                DCB      0
                  |L1.3768|
000eb8  3600              DCB      "6",0
000eba  00                DCB      0
000ebb  00                DCB      0
                  |L1.3772|
000ebc  5b564f4c          DCB      "[VOL+ TV]\r",0
000ec0  2b205456
000ec4  5d0d00  
000ec7  00                DCB      0
                  |L1.3784|
000ec8  313600            DCB      "16",0
000ecb  00                DCB      0
                  |L1.3788|
000ecc  5b4c4546          DCB      "[LEFT HOME]\r",0
000ed0  5420484f
000ed4  4d455d0d
000ed8  00      
000ed9  00                DCB      0
000eda  00                DCB      0
000edb  00                DCB      0
                  |L1.3804|
000edc  313700            DCB      "17",0
000edf  00                DCB      0
                  |L1.3808|
000ee0  5b524947          DCB      "[RIGH HOME]\r",0
000ee4  4820484f
000ee8  4d455d0d
000eec  00      
000eed  00                DCB      0
000eee  00                DCB      0
000eef  00                DCB      0
                  |L1.3824|
000ef0  3800              DCB      "8",0
000ef2  00                DCB      0
000ef3  00                DCB      0
                  |L1.3828|
000ef4  5b564f4c          DCB      "[VOL- HOME]\r",0
000ef8  2d20484f
000efc  4d455d0d
000f00  00      
000f01  00                DCB      0
000f02  00                DCB      0
000f03  00                DCB      0
                  |L1.3844|
000f04  3900              DCB      "9",0
000f06  00                DCB      0
000f07  00                DCB      0
                  |L1.3848|
000f08  5b564f4c          DCB      "[VOL+ HOME]\r",0
000f0c  2b20484f
000f10  4d455d0d
000f14  00      
000f15  00                DCB      0
000f16  00                DCB      0
000f17  00                DCB      0
                  |L1.3864|
000f18  313800            DCB      "18",0
000f1b  00                DCB      0
                  |L1.3868|
000f1c  5b444f57          DCB      "[DOWN HOME]\r",0
000f20  4e20484f
000f24  4d455d0d
000f28  00      
000f29  00                DCB      0
000f2a  00                DCB      0
000f2b  00                DCB      0
                  |L1.3884|
000f2c  313200            DCB      "12",0
000f2f  00                DCB      0
                  |L1.3888|
000f30  313300            DCB      "13",0
000f33  00                DCB      0
                  |L1.3892|
000f34  504c4159          DCB      "PLAY",0
000f38  00      
000f39  00                DCB      0
000f3a  00                DCB      0
000f3b  00                DCB      0
                  |L1.3900|
000f3c  50415553          DCB      "PAUSE",0
000f40  4500    
000f42  00                DCB      0
000f43  00                DCB      0
                  |L1.3908|
000f44  5b257320          DCB      "[%s HOME]\r",0
000f48  484f4d45
000f4c  5d0d00  
000f4f  00                DCB      0
                  |L1.3920|
000f50  313400            DCB      "14",0
000f53  00                DCB      0
                  |L1.3924|
000f54  5b424143          DCB      "[BACK HOME]\r",0
000f58  4b20484f
000f5c  4d455d0d
000f60  00      
000f61  00                DCB      0
000f62  00                DCB      0
000f63  00                DCB      0
                  |L1.3940|
000f64  313500            DCB      "15",0
000f67  00                DCB      0
                  |L1.3944|
000f68  5b4e4558          DCB      "[NEXT HOME]\r",0
000f6c  5420484f
000f70  4d455d0d
000f74  00      
000f75  00                DCB      0
000f76  00                DCB      0
000f77  00                DCB      0
                  |L1.3960|
000f78  333400            DCB      "34",0
000f7b  00                DCB      0
                  |L1.3964|
000f7c  333500            DCB      "35",0
000f7f  00                DCB      0
                  |L1.3968|
000f80  5b25735d          DCB      "[%s] [SWING %s] [IR ID:%s] [POWER %s AR]\r",0
000f84  205b5357
000f88  494e4720
000f8c  25735d20
000f90  5b495220
000f94  49443a25
000f98  735d205b
000f9c  504f5745
000fa0  52202573
000fa4  2041525d
000fa8  0d00    
000faa  00                DCB      0
000fab  00                DCB      0
                  |L1.4012|
000fac  333600            DCB      "36",0
000faf  00                DCB      0
                  |L1.4016|
000fb0  333700            DCB      "37",0
000fb3  00                DCB      0
                  |L1.4020|
000fb4  5b25735d          DCB      "[%s] [SWING %s] [IR ID:%s] [TEMP %u",176,"]\r",0
000fb8  205b5357
000fbc  494e4720
000fc0  25735d20
000fc4  5b495220
000fc8  49443a25
000fcc  735d205b
000fd0  54454d50
000fd4  202575b0
000fd8  5d0d00  
000fdb  00                DCB      0
                  |L1.4060|
                          DCD      ||.bss||
                  |L1.4064|
000fe0  4f4b2025          DCB      "OK %u",0
000fe4  7500    
000fe6  00                DCB      0
000fe7  00                DCB      0
                  |L1.4072|
000fe8  5b546f75          DCB      "[Touch:%u] [IR ID:%s] %s\r",0
000fec  63683a25
000ff0  755d205b
000ff4  49522049
000ff8  443a2573
000ffc  5d202573
001000  0d00    
001002  00                DCB      0
001003  00                DCB      0
                  |L1.4100|
                          DCD      __stdout
                  |L1.4104|
                          DCD      current_id_scene
                  |L1.4108|
                          DCD      scene
                  |L1.4112|
001010  44494d4d          DCB      "DIMMER\\SCENE_",0
001014  45525c53
001018  43454e45
00101c  5f00    
00101e  00                DCB      0
00101f  00                DCB      0
                  |L1.4128|
                          DCD      aux_scene
                  |L1.4132|
001024  25732575          DCB      "%s%u",0
001028  00      
001029  00                DCB      0
00102a  00                DCB      0
00102b  00                DCB      0
                  |L1.4140|
00102c  53455420          DCB      "SET 0000000000007",0
001030  30303030
001034  30303030
001038  30303030
00103c  3700    
00103e  00                DCB      0
00103f  00                DCB      0
                  |L1.4160|
                          DCD      current_scene
                  |L1.4164|
001044  53455400          DCB      "SET",0
                  |L1.4168|
                          DCD      ||.data||
                  |L1.4172|
00104c  43656e61          DCB      "Cena %u configurada: %s\r",0
001050  20257520
001054  636f6e66
001058  69677572
00105c  6164613a
001060  2025730d
001064  00      
001065  00                DCB      0
001066  00                DCB      0
001067  00                DCB      0
                  |L1.4200|
001068  48c1              LDR      r0,|L1.4976|
00106a  f7fffffe          BL       fflush
00106e  e69f              B        |L1.3504|
                  |L1.4208|
001070  4629              MOV      r1,r5
001072  2002              MOVS     r0,#2                 ;1047
001074  f7fffffe          BL       uart_putString
001078  f2af7128          ADR      r1,|L1.2388|
00107c  2002              MOVS     r0,#2                 ;1048
00107e  f7fffffe          BL       uart_putString
001082  4629              MOV      r1,r5                 ;1048
001084  48bb              LDR      r0,|L1.4980|
001086  f7fffffe          BL       strcpy
00108a  7034              STRB     r4,[r6,#0]            ;1050
00108c  e690              B        |L1.3504|
;;;1060   
                          ENDP

                  cmd_run_scene PROC
;;;1063   *****************************************************************************/
;;;1064   void cmd_run_scene(char *par) 
00108e  b570              PUSH     {r4-r6,lr}
;;;1065   {
;;;1066   	char addr;
;;;1067   
;;;1068   	addr = atoi(par);
001090  f7fffffe          BL       atoi
001094  b2c4              UXTB     r4,r0
;;;1069   	if(addr >= NUM_SCENE)	/*Endereço da cena incorreto?*/
001096  2c04              CMP      r4,#4
001098  d307              BCC      |L1.4266|
;;;1070   		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);
00109a  2207              MOVS     r2,#7
00109c  f6af4100          ADR      r1,|L1.1184|
0010a0  e8bd4070          POP      {r4-r6,lr}
0010a4  48b4              LDR      r0,|L1.4984|
0010a6  f7ffbffe          B.W      __2sprintf
                  |L1.4266|
;;;1071   	else
;;;1072   	{
;;;1073   		/*Envia imediatamente para o LPC1113 a cena de endereço 'addr' */
;;;1074   		uart_putString(UART_LINK_LPC,scene[addr]);
0010aa  48b4              LDR      r0,|L1.4988|
0010ac  ebc41104          RSB      r1,r4,r4,LSL #4
0010b0  eb000141          ADD      r1,r0,r1,LSL #1
0010b4  460d              MOV      r5,r1
0010b6  2002              MOVS     r0,#2
0010b8  f7fffffe          BL       uart_putString
;;;1075   		uart_putString(UART_LINK_LPC,"!\0");
0010bc  f2af716c          ADR      r1,|L1.2388|
0010c0  2002              MOVS     r0,#2
0010c2  f7fffffe          BL       uart_putString
0010c6  4629              MOV      r1,r5
;;;1076   		
;;;1077   		strcpy(current_scene,scene[addr]); 			/*Copia para a cena atual*/
0010c8  48aa              LDR      r0,|L1.4980|
0010ca  f7fffffe          BL       strcpy
;;;1078   		current_id_scene = addr;
0010ce  48ac              LDR      r0,|L1.4992|
0010d0  4623              MOV      r3,r4
0010d2  462a              MOV      r2,r5
0010d4  7004              STRB     r4,[r0,#0]
;;;1079   
;;;1080   		sprintf(buf_tx,"%s%u",scene[addr],current_id_scene);		
0010d6  f2af01b4          ADR      r1,|L1.4132|
0010da  e8bd4070          POP      {r4-r6,lr}
0010de  48a6              LDR      r0,|L1.4984|
0010e0  f7ffbffe          B.W      __2sprintf
;;;1081   	}
;;;1082   }
;;;1083   
                          ENDP

                  cmd_ena_dis_func PROC
;;;1086   *****************************************************************************/
;;;1087   void cmd_ena_dis_func(char *par) 
0010e4  b570              PUSH     {r4-r6,lr}
;;;1088   {
0010e6  4604              MOV      r4,r0
;;;1089   	if(par[0] == '0')	/*Função IR Scene*/
0010e8  7800              LDRB     r0,[r0,#0]
0010ea  2830              CMP      r0,#0x30
0010ec  d003              BEQ      |L1.4342|
;;;1090   	{
;;;1091   	  	if(par[1] == '1' && !atoi(cfg.file.func_ir_scene))
;;;1092   		{
;;;1093   			strcpy(cfg.file.func_ir_scene,"1\0");
;;;1094   			fwrite_line(cfg.file.func_ir_scene, FILE_CFG_CFG, LINE_FUNC_IR_SCENE);
;;;1095   		}else
;;;1096   		if(par[1] == '0' && atoi(cfg.file.func_ir_scene))
;;;1097   		{
;;;1098   			strcpy(cfg.file.func_ir_scene,"0\0");
;;;1099   			fwrite_line(cfg.file.func_ir_scene, FILE_CFG_CFG, LINE_FUNC_IR_SCENE);
;;;1100   		}
;;;1101   		sprintf(buf_tx,"FUN 0%s",cfg.file.func_ir_scene);
;;;1102   
;;;1103   	}else
;;;1104   		sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);		
0010ee  2207              MOVS     r2,#7
0010f0  f6af4154          ADR      r1,|L1.1184|
0010f4  e023              B        |L1.4414|
                  |L1.4342|
0010f6  7860              LDRB     r0,[r4,#1]            ;1091
0010f8  4da2              LDR      r5,|L1.4996|
0010fa  2831              CMP      r0,#0x31              ;1091
0010fc  d103              BNE      |L1.4358|
0010fe  4628              MOV      r0,r5                 ;1091
001100  f7fffffe          BL       atoi
001104  b118              CBZ      r0,|L1.4366|
                  |L1.4358|
001106  7860              LDRB     r0,[r4,#1]            ;1096
001108  2830              CMP      r0,#0x30              ;1096
00110a  d005              BEQ      |L1.4376|
00110c  e015              B        |L1.4410|
                  |L1.4366|
00110e  489d              LDR      r0,|L1.4996|
001110  388b              SUBS     r0,r0,#0x8b           ;1093
001112  f6af4148          ADR      r1,|L1.1228|
001116  e007              B        |L1.4392|
                  |L1.4376|
001118  4628              MOV      r0,r5                 ;1094
00111a  f7fffffe          BL       atoi
00111e  b160              CBZ      r0,|L1.4410|
001120  4898              LDR      r0,|L1.4996|
001122  388b              SUBS     r0,r0,#0x8b           ;1098
001124  f6af4160          ADR      r1,|L1.1224|
                  |L1.4392|
001128  8809              LDRH     r1,[r1,#0]            ;1098
00112a  f8a0108b          STRH     r1,[r0,#0x8b]         ;1098
00112e  2201              MOVS     r2,#1                 ;1099
001130  f6af4180          ADR      r1,|L1.1204|
001134  4628              MOV      r0,r5                 ;1099
001136  f7fffffe          BL       fwrite_line
                  |L1.4410|
00113a  462a              MOV      r2,r5                 ;1099
00113c  a192              ADR      r1,|L1.5000|
                  |L1.4414|
00113e  e8bd4070          POP      {r4-r6,lr}
001142  488d              LDR      r0,|L1.4984|
001144  f7ffbffe          B.W      __2sprintf
;;;1105   }
;;;1106   
                          ENDP

                  cmd_rel PROC
;;;1109   *****************************************************************************/
;;;1110   void cmd_rel(char *par) 
001148  b510              PUSH     {r4,lr}
;;;1111   {
;;;1112   /*
;;;1113   	exemplo "SET .........1..!"	 //Configura apenas o rele 0 (Liga)
;;;1114   	exemplo "SET .........0..!"	 //Configura apenas o rele 0 (Desliga)
;;;1115   	exemplo "SET ..........1.!"	 //Configura apenas o rele 1 (Liga)
;;;1116   	exemplo "SET ..........0.!"	 //Configura apenas o rele 1 (Desliga)
;;;1117   	exemplo "SET ...........1!"	 //Configura apenas o rele 2 (Liga)
;;;1118   	exemplo "SET ...........0!"	 //Configura apenas o rele 2 (Desliga)
;;;1119   */
;;;1120   
;;;1121   	switch(par[0])
00114a  7801              LDRB     r1,[r0,#0]
00114c  2930              CMP      r1,#0x30
00114e  d00b              BEQ      |L1.4456|
001150  2931              CMP      r1,#0x31
001152  d011              BEQ      |L1.4472|
001154  2932              CMP      r1,#0x32
001156  d02b              BEQ      |L1.4528|
;;;1122   	{
;;;1123   		case '0':	/*Rele 0*/
;;;1124   			sprintf(buf_tx,"SET .........%c..!",(par[1] == '0') ? '0':'1');
;;;1125   			break;
;;;1126   
;;;1127   		case '1':	/*Rele 1*/
;;;1128   			sprintf(buf_tx,"SET ..........%c.!",(par[1] == '0') ? '0':'1');
;;;1129   			break;
;;;1130   
;;;1131   		case '2':	/*Rele 2*/
;;;1132   			sprintf(buf_tx,"SET ...........%c!",(par[1] == '0') ? '0':'1');
;;;1133   			break;
;;;1134   
;;;1135   		default:
;;;1136   			sprintf(buf_tx,"ERROR %u",ERROR_PARAMETER);
001158  2207              MOVS     r2,#7
00115a  f6af41bc          ADR      r1,|L1.1184|
00115e  e8bd4010          POP      {r4,lr}
001162  4885              LDR      r0,|L1.4984|
001164  f7ffbffe          B.W      __2sprintf
                  |L1.4456|
001168  7840              LDRB     r0,[r0,#1]            ;1124
00116a  2830              CMP      r0,#0x30              ;1124
00116c  d002              BEQ      |L1.4468|
00116e  2231              MOVS     r2,#0x31              ;1124
                  |L1.4464|
001170  a187              ADR      r1,|L1.5008|
001172  e006              B        |L1.4482|
                  |L1.4468|
001174  2230              MOVS     r2,#0x30              ;1124
001176  e7fb              B        |L1.4464|
                  |L1.4472|
001178  7840              LDRB     r0,[r0,#1]            ;1128
00117a  2830              CMP      r0,#0x30              ;1128
00117c  d016              BEQ      |L1.4524|
00117e  2231              MOVS     r2,#0x31              ;1128
                  |L1.4480|
001180  a188              ADR      r1,|L1.5028|
                  |L1.4482|
001182  487d              LDR      r0,|L1.4984|
001184  f7fffffe          BL       __2sprintf
;;;1137   			return;
;;;1138   	}
;;;1139   	printf("%s\r",buf_tx);
001188  497b              LDR      r1,|L1.4984|
00118a  a08b              ADR      r0,|L1.5048|
00118c  f7fffffe          BL       __2printf
;;;1140   	fflush(stdout);
001190  4877              LDR      r0,|L1.4976|
001192  f7fffffe          BL       fflush
;;;1141   	uart_putString(UART_LINK_LPC,buf_tx);
001196  4978              LDR      r1,|L1.4984|
001198  2002              MOVS     r0,#2
00119a  f7fffffe          BL       uart_putString
;;;1142   	sprintf(buf_tx,"OK");
00119e  f6af0148          ADR      r1,|L1.2392|
0011a2  e8bd4010          POP      {r4,lr}
0011a6  4874              LDR      r0,|L1.4984|
0011a8  f7ffbffe          B.W      __2sprintf
                  |L1.4524|
0011ac  2230              MOVS     r2,#0x30              ;1128
0011ae  e7e7              B        |L1.4480|
                  |L1.4528|
0011b0  7840              LDRB     r0,[r0,#1]            ;1132
0011b2  2830              CMP      r0,#0x30              ;1132
0011b4  d002              BEQ      |L1.4540|
0011b6  2231              MOVS     r2,#0x31              ;1132
                  |L1.4536|
0011b8  a180              ADR      r1,|L1.5052|
0011ba  e7e2              B        |L1.4482|
                  |L1.4540|
0011bc  2230              MOVS     r2,#0x30              ;1132
0011be  e7fb              B        |L1.4536|
;;;1143   }
;;;1144   
                          ENDP

                  cmd_msg_dimmer PROC
;;;1147   *****************************************************************************/
;;;1148   void cmd_msg_dimmer(char *par) 
0011c0  f6af016c          ADR      r1,|L1.2392|
;;;1149   {
;;;1150   	sprintf(buf_tx,"OK"); 	
0011c4  486c              LDR      r0,|L1.4984|
0011c6  f7ffbffe          B.W      __2sprintf
;;;1151   }
;;;1152   /*****************************************************************************
                          ENDP

                  cmd_task PROC
;;;1154   *****************************************************************************/
;;;1155   void cmd_task(void)
0011ca  e92d4ff8          PUSH     {r3-r11,lr}
;;;1156   {
;;;1157   	static char rst = 0;
;;;1158   	char *sp,*cp,*next; //,str[4];
;;;1159   	long i=0;
;;;1160   
;;;1161   	if(rcv_cmd)
0011ce  4d80              LDR      r5,|L1.5072|
0011d0  2400              MOVS     r4,#0                 ;1159
0011d2  7828              LDRB     r0,[r5,#0]  ; rcv_cmd
0011d4  2800              CMP      r0,#0
0011d6  d071              BEQ      |L1.4796|
;;;1162   	{
;;;1163   		rcv = 0;
0011d8  2700              MOVS     r7,#0
;;;1164   		wdt_feed();
0011da  f04f4880          MOV      r8,#0x40000000
0011de  706f              STRB     r7,[r5,#1]            ;1163
0011e0  f04f09aa          MOV      r9,#0xaa
0011e4  f8889008          STRB     r9,[r8,#8]
0011e8  f04f0a55          MOV      r10,#0x55
0011ec  f888a008          STRB     r10,[r8,#8]
;;;1165     		sp = get_entry (&buf_rx[0], &next);
0011f0  4861              LDR      r0,|L1.4984|
0011f2  4669              MOV      r1,sp
0011f4  30a0              ADDS     r0,r0,#0xa0
0011f6  f7fffffe          BL       get_entry
0011fa  4606              MOV      r6,r0
;;;1166     		if(*sp == 0)
0011fc  7800              LDRB     r0,[r0,#0]
0011fe  b108              CBZ      r0,|L1.4612|
;;;1167   		{
;;;1168   			if(rst++ >= 10)
;;;1169   			{
;;;1170   				printf ("[FAIL CMD..restart now]\r");
;;;1171   				fflush(stdout);
;;;1172   				LPC_WDT->WDTC = 0x003FFFF;	/*0.5s*/
;;;1173   				wdt_feed();
;;;1174   				while(1);			
;;;1175   			}
;;;1176   			sprintf(buf_tx,"ERROR %u",ERROR_COMMAND);
;;;1177       	}else
;;;1178   		{
;;;1179       		for (cp = sp; *cp && *cp != ' '; cp++)
001200  4634              MOV      r4,r6
001202  e01d              B        |L1.4672|
                  |L1.4612|
001204  78a8              LDRB     r0,[r5,#2]            ;1168  ; rst
001206  1c41              ADDS     r1,r0,#1              ;1168
001208  70a9              STRB     r1,[r5,#2]            ;1168
00120a  280a              CMP      r0,#0xa               ;1168
00120c  d30d              BCC      |L1.4650|
00120e  a071              ADR      r0,|L1.5076|
001210  f7fffffe          BL       __2printf
001214  4856              LDR      r0,|L1.4976|
001216  f7fffffe          BL       fflush
00121a  4975              LDR      r1,|L1.5104|
00121c  f8c81004          STR      r1,[r8,#4]            ;1172
001220  f8889008          STRB     r9,[r8,#8]            ;1173
001224  f888a008          STRB     r10,[r8,#8]           ;1173
                  |L1.4648|
001228  e7fe              B        |L1.4648|
                  |L1.4650|
00122a  2200              MOVS     r2,#0                 ;1176
00122c  f6af5190          ADR      r1,|L1.1184|
001230  4851              LDR      r0,|L1.4984|
001232  f7fffffe          BL       __2sprintf
001236  e019              B        |L1.4716|
                  |L1.4664|
;;;1180   				*cp = toupper (*cp);
001238  f7fffffe          BL       toupper
00123c  f8040b01          STRB     r0,[r4],#1
                  |L1.4672|
001240  7820              LDRB     r0,[r4,#0]            ;1179
001242  b108              CBZ      r0,|L1.4680|
001244  2820              CMP      r0,#0x20              ;1179
001246  d1f7              BNE      |L1.4664|
                  |L1.4680|
;;;1181   		
;;;1182       		for (i = 0; i < CMD_COUNT; i++)
;;;1183   			{
;;;1184         			if (strcmp (sp, (const char *)&cmd[i].val))
001248  f8df81a8          LDR      r8,|L1.5108|
00124c  2400              MOVS     r4,#0                 ;1182
                  |L1.4686|
00124e  eb040144          ADD      r1,r4,r4,LSL #1
001252  eb080181          ADD      r1,r8,r1,LSL #2
001256  4630              MOV      r0,r6
001258  f7fffffe          BL       strcmp
00125c  b190              CBZ      r0,|L1.4740|
00125e  1c64              ADDS     r4,r4,#1              ;1182
001260  2c15              CMP      r4,#0x15              ;1182
001262  d3f4              BCC      |L1.4686|
                  |L1.4708|
;;;1185           			continue;
;;;1186         			cmd[i].func (next);		
;;;1187   				rst = 0;
;;;1188   				break;
;;;1189       		}
;;;1190   		}
;;;1191   
;;;1192   		if(i == CMD_COUNT)
001264  2c15              CMP      r4,#0x15
001266  d0e0              BEQ      |L1.4650|
;;;1193   			sprintf(buf_tx,"ERROR %u",ERROR_COMMAND);
;;;1194   			  
;;;1195   
;;;1196   		if(i!=6 && rcv_cmd == RCV_CMD_UART_0)	/*i=6 (Rcv Touch lpc1113)*/
001268  2c06              CMP      r4,#6
00126a  d019              BEQ      |L1.4768|
                  |L1.4716|
00126c  7828              LDRB     r0,[r5,#0]  ; rcv_cmd
00126e  4942              LDR      r1,|L1.4984|
001270  2801              CMP      r0,#1
001272  d028              BEQ      |L1.4806|
;;;1197   		{
;;;1198   			if(buf_tx[0] == 'E')
;;;1199   				beep(BEEP_ERROR);
;;;1200   			else
;;;1201   				beep(BEEP_CFG);
;;;1202   		}else
;;;1203   			/*Função IR learn, IR learn Scene, Detect Swing e IR learn app via TCP?*/
;;;1204   		if((i == 0 || i == 12 || i == 13 || i == 17) && (rcv_cmd == RCV_CMD_TCP_SERVER || rcv_cmd == RCV_CMD_TCP_CLIENT)) 
001274  b31c              CBZ      r4,|L1.4798|
001276  2c0c              CMP      r4,#0xc
001278  d021              BEQ      |L1.4798|
00127a  2c0d              CMP      r4,#0xd
00127c  d01f              BEQ      |L1.4798|
00127e  2c11              CMP      r4,#0x11
001280  d01d              BEQ      |L1.4798|
001282  e00d              B        |L1.4768|
                  |L1.4740|
001284  eb040144          ADD      r1,r4,r4,LSL #1       ;1186
001288  eb080081          ADD      r0,r8,r1,LSL #2       ;1186
00128c  6881              LDR      r1,[r0,#8]            ;1186
00128e  9800              LDR      r0,[sp,#0]            ;1186
001290  4788              BLX      r1                    ;1186
001292  70af              STRB     r7,[r5,#2]            ;1187
001294  e7e6              B        |L1.4708|
                  |L1.4758|
001296  2003              MOVS     r0,#3                 ;1199
001298  e000              B        |L1.4764|
                  |L1.4762|
00129a  2001              MOVS     r0,#1                 ;1201
                  |L1.4764|
;;;1205   		{
;;;1206   			if(buf_tx[0] == 'E')
;;;1207   				beep(BEEP_ERROR);
00129c  f7fffffe          BL       beep
                  |L1.4768|
;;;1208   			else
;;;1209   				beep(BEEP_CFG);
;;;1210   		}
;;;1211   		
;;;1212   		strcat(buf_tx,"\r\n\0");
0012a0  a155              ADR      r1,|L1.5112|
0012a2  4835              LDR      r0,|L1.4984|
0012a4  f7fffffe          BL       strcat
;;;1213   
;;;1214   		if(rcv_cmd == RCV_CMD_UART_2)	
0012a8  7828              LDRB     r0,[r5,#0]  ; rcv_cmd
0012aa  2802              CMP      r0,#2
0012ac  d013              BEQ      |L1.4822|
;;;1215   		{
;;;1216   //			uart_putString(2,buf_tx);
;;;1217   		}else
;;;1218   		if(rcv_cmd == RCV_CMD_UART_0)
0012ae  2801              CMP      r0,#1
0012b0  d00d              BEQ      |L1.4814|
;;;1219   			uart_putString(0,buf_tx);
;;;1220   			
;;;1221   #if USE_TCP_CLIENT	/*Comunicação TCP CLIENT será usada?*/
;;;1222   		else
;;;1223   		if((rcv_cmd == RCV_CMD_TCP_CLIENT))
0012b2  2803              CMP      r0,#3
0012b4  d01b              BEQ      |L1.4846|
;;;1224   		{
;;;1225   			tcpSend (buf_tx, strlen(buf_tx), last_soc_client,CMD_SEND_TO_CLIENT);
;;;1226   			uart_putString(0,buf_tx);
;;;1227   		}
;;;1228   #endif
;;;1229   
;;;1230   #if USE_TCP_SERVER	/*Comunicação TCP SERVER será usada?*/
;;;1231   		else
;;;1232   		if((rcv_cmd == RCV_CMD_TCP_SERVER))
0012b6  2804              CMP      r0,#4
0012b8  d020              BEQ      |L1.4860|
0012ba  e00c              B        |L1.4822|
                  |L1.4796|
0012bc  e032              B        |L1.4900|
                  |L1.4798|
0012be  2804              CMP      r0,#4                 ;1204
0012c0  d001              BEQ      |L1.4806|
0012c2  2803              CMP      r0,#3                 ;1204
0012c4  d1ec              BNE      |L1.4768|
                  |L1.4806|
0012c6  7808              LDRB     r0,[r1,#0]            ;1206  ; buf_tx
0012c8  2845              CMP      r0,#0x45              ;1206
0012ca  d1e6              BNE      |L1.4762|
0012cc  e7e3              B        |L1.4758|
                  |L1.4814|
0012ce  492a              LDR      r1,|L1.4984|
0012d0  2000              MOVS     r0,#0                 ;1219
0012d2  f7fffffe          BL       uart_putString
                  |L1.4822|
;;;1233   		{
;;;1234   			tcpSend (buf_tx, strlen(buf_tx), tcp_server_soc,CMD_SEND_TO_SERVER);
;;;1235   			uart_putString(0,buf_tx);
;;;1236   		}
;;;1237   #endif			
;;;1238   	
;;;1239   		memset(buf_rx,0,sizeof(buf_rx));
0012d6  4828              LDR      r0,|L1.4984|
0012d8  21a0              MOVS     r1,#0xa0
0012da  30a0              ADDS     r0,r0,#0xa0
0012dc  f7fffffe          BL       __aeabi_memclr
;;;1240   		memset(buf_tx,0,sizeof(buf_tx));
0012e0  21a0              MOVS     r1,#0xa0
0012e2  4825              LDR      r0,|L1.4984|
0012e4  f7fffffe          BL       __aeabi_memclr
;;;1241   		if(!rcv)
0012e8  7868              LDRB     r0,[r5,#1]  ; rcv
0012ea  b190              CBZ      r0,|L1.4882|
0012ec  e012              B        |L1.4884|
                  |L1.4846|
0012ee  4822              LDR      r0,|L1.4984|
0012f0  f7fffffe          BL       strlen
0012f4  b2c1              UXTB     r1,r0                 ;1225
0012f6  2301              MOVS     r3,#1                 ;1225
0012f8  4840              LDR      r0,|L1.5116|
0012fa  e005              B        |L1.4872|
                  |L1.4860|
0012fc  481e              LDR      r0,|L1.4984|
0012fe  f7fffffe          BL       strlen
001302  b2c1              UXTB     r1,r0                 ;1234
001304  483e              LDR      r0,|L1.5120|
001306  2300              MOVS     r3,#0                 ;1234
                  |L1.4872|
001308  7802              LDRB     r2,[r0,#0]            ;1234  ; tcp_server_soc
00130a  481b              LDR      r0,|L1.4984|
00130c  f7fffffe          BL       tcpSend
001310  e7dd              B        |L1.4814|
                  |L1.4882|
;;;1242   			rcv_cmd = __FALSE;
001312  702f              STRB     r7,[r5,#0]
                  |L1.4884|
;;;1243   		cntUART2 = 0;
;;;1244   		cntUART0 = 0;
001314  60af              STR      r7,[r5,#8]  ; cntUART2
;;;1245   		NVIC_EnableIRQ(UART2_IRQn);
001316  2007              MOVS     r0,#7
001318  60ef              STR      r7,[r5,#0xc]  ; cntUART0
00131a  f7fffffe          BL       NVIC_EnableIRQ
;;;1246   		NVIC_EnableIRQ(UART0_IRQn);
00131e  2005              MOVS     r0,#5
001320  f7fffffe          BL       NVIC_EnableIRQ
                  |L1.4900|
;;;1247   	}
;;;1248   }
001324  e8bd8ff8          POP      {r3-r11,pc}
;;;1249   
                          ENDP

                  NVIC_EnableIRQ PROC
;;;1095    */
;;;1096   static __INLINE void NVIC_EnableIRQ(IRQn_Type IRQn)
001328  f000021f          AND      r2,r0,#0x1f
;;;1097   {
;;;1098     NVIC->ISER[((uint32_t)(IRQn) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F)); /* enable interrupt */
00132c  2101              MOVS     r1,#1
00132e  4091              LSLS     r1,r1,r2
001330  0940              LSRS     r0,r0,#5
001332  f04f22e0          MOV      r2,#0xe000e000
001336  eb020080          ADD      r0,r2,r0,LSL #2
00133a  f8c01100          STR      r1,[r0,#0x100]
;;;1099   }
00133e  4770              BX       lr
;;;1100   
                          ENDP

                  NVIC_DisableIRQ PROC
;;;1109    */
;;;1110   static __INLINE void NVIC_DisableIRQ(IRQn_Type IRQn)
001340  f000021f          AND      r2,r0,#0x1f
;;;1111   {
;;;1112     NVIC->ICER[((uint32_t)(IRQn) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F)); /* disable interrupt */
001344  2101              MOVS     r1,#1
001346  4091              LSLS     r1,r1,r2
001348  0940              LSRS     r0,r0,#5
00134a  f04f22e0          MOV      r2,#0xe000e000
00134e  eb020080          ADD      r0,r2,r0,LSL #2
001352  f8c01180          STR      r1,[r0,#0x180]
;;;1113   }
001356  4770              BX       lr
;;;1114   
                          ENDP

                  NVIC_ClearPendingIRQ PROC
;;;1151    */
;;;1152   static __INLINE void NVIC_ClearPendingIRQ(IRQn_Type IRQn)
001358  f000021f          AND      r2,r0,#0x1f
;;;1153   {
;;;1154     NVIC->ICPR[((uint32_t)(IRQn) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F)); /* Clear pending interrupt */
00135c  2101              MOVS     r1,#1
00135e  4091              LSLS     r1,r1,r2
001360  0940              LSRS     r0,r0,#5
001362  f04f22e0          MOV      r2,#0xe000e000
001366  eb020080          ADD      r0,r2,r0,LSL #2
00136a  f8c01280          STR      r1,[r0,#0x280]
;;;1155   }
00136e  4770              BX       lr
;;;1156   
                          ENDP

                  |L1.4976|
                          DCD      __stdout
                  |L1.4980|
                          DCD      current_scene
                  |L1.4984|
                          DCD      ||.bss||
                  |L1.4988|
                          DCD      scene
                  |L1.4992|
                          DCD      current_id_scene
                  |L1.4996|
                          DCD      ||cfg||+0x8b
                  |L1.5000|
001388  46554e20          DCB      "FUN 0%s",0
00138c  30257300
                  |L1.5008|
001390  53455420          DCB      "SET .........%c..!",0
001394  2e2e2e2e
001398  2e2e2e2e
00139c  2e25632e
0013a0  2e2100  
0013a3  00                DCB      0
                  |L1.5028|
0013a4  53455420          DCB      "SET ..........%c.!",0
0013a8  2e2e2e2e
0013ac  2e2e2e2e
0013b0  2e2e2563
0013b4  2e2100  
0013b7  00                DCB      0
                  |L1.5048|
0013b8  25730d00          DCB      "%s\r",0
                  |L1.5052|
0013bc  53455420          DCB      "SET ...........%c!",0
0013c0  2e2e2e2e
0013c4  2e2e2e2e
0013c8  2e2e2e25
0013cc  632100  
0013cf  00                DCB      0
                  |L1.5072|
                          DCD      ||.data||
                  |L1.5076|
0013d4  5b464149          DCB      "[FAIL CMD..restart now]\r",0
0013d8  4c20434d
0013dc  442e2e72
0013e0  65737461
0013e4  7274206e
0013e8  6f775d0d
0013ec  00      
0013ed  00                DCB      0
0013ee  00                DCB      0
0013ef  00                DCB      0
                  |L1.5104|
                          DCD      0x0003ffff
                  |L1.5108|
                          DCD      ||.constdata||
                  |L1.5112|
0013f8  0d0a00            DCB      "\r\n",0
0013fb  00                DCB      0
                  |L1.5116|
                          DCD      last_soc_client
                  |L1.5120|
                          DCD      tcp_server_soc

                          AREA ||.bss||, DATA, NOINIT, ALIGN=0

                  buf_tx
                          %        160
                  buf_rx
                          %        160

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

                  ||cmd||
000000  49524c00          DCB      0x49,0x52,0x4c,0x00
                          DCD      0x00000000
                          DCD      cmd_ir_learn
00000c  49525300          DCB      0x49,0x52,0x53,0x00
                          DCD      0x00000000
                          DCD      cmd_ir_send
000018  49524500          DCB      0x49,0x52,0x45,0x00
                          DCD      0x00000000
                          DCD      cmd_ir_erase
000024  49524541          DCB      0x49,0x52,0x45,0x41
000028  00000000          DCB      0x00,0x00,0x00,0x00
                          DCD      cmd_ir_erase_all
000030  49525200          DCB      0x49,0x52,0x52,0x00
                          DCD      0x00000000
                          DCD      cmd_ir_read
00003c  52535400          DCB      0x52,0x53,0x54,0x00
                          DCD      0x00000000
                          DCD      cmd_reset_board
000048  544f5500          DCB      0x54,0x4f,0x55,0x00
                          DCD      0x00000000
                          DCD      cmd_rcv_touch
000054  53434500          DCB      0x53,0x43,0x45,0x00
                          DCD      0x00000000
                          DCD      cmd_scene
000060  52534300          DCB      0x52,0x53,0x43,0x00
                          DCD      0x00000000
                          DCD      cmd_run_scene
00006c  4d534700          DCB      0x4d,0x53,0x47,0x00
                          DCD      0x00000000
                          DCD      cmd_msg_dimmer
000078  53574900          DCB      0x53,0x57,0x49,0x00
                          DCD      0x00000000
                          DCD      cmd_ar_swing
000084  53455400          DCB      0x53,0x45,0x54,0x00
                          DCD      0x00000000
                          DCD      cmd_set_real_time
000090  4c534300          DCB      0x4c,0x53,0x43,0x00
                          DCD      0x00000000
                          DCD      cmd_irl_scene
00009c  4c494100          DCB      0x4c,0x49,0x41,0x00
                          DCD      0x00000000
                          DCD      cmd_ir_learn_app
0000a8  53494100          DCB      0x53,0x49,0x41,0x00
                          DCD      0x00000000
                          DCD      cmd_ir_send_app
0000b4  52454c00          DCB      0x52,0x45,0x4c,0x00
                          DCD      0x00000000
                          DCD      cmd_rel
0000c0  46554e00          DCB      0x46,0x55,0x4e,0x00
                          DCD      0x00000000
                          DCD      cmd_ena_dis_func
0000cc  44545300          DCB      0x44,0x54,0x53,0x00
                          DCD      0x00000000
                          DCD      cmd_detect_swing
0000d8  54444900          DCB      0x54,0x44,0x49,0x00
                          DCD      0x00000000
                          DCD      cmd_type_dim
0000e4  454e5400          DCB      0x45,0x4e,0x54,0x00
                          DCD      0x00000000
                          DCD      cmd_enable_touch
0000f0  44495400          DCB      0x44,0x49,0x54,0x00
                          DCD      0x00000000
                          DCD      cmd_disable_touch

                          AREA ||.data||, DATA, ALIGN=2

                  rcv_cmd
000000  00                DCB      0x00
                  ||rcv||
000001  00                DCB      0x00
                  ||rst||
000002  0000              DCB      0x00,0x00
                  ||lp||
                          DCD      0x00000000
                  cntUART2
                          DCD      0x00000000
                  cntUART0
                          DCD      0x00000000
